<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>ts-lambda-api - v2.4.2</title><meta name="description" content="Documentation for ts-lambda-api"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/search.js" id="tsd-search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">ts-lambda-api - v2.4.2</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-content">
<div class="tsd-page-title">
<h2>ts-lambda-api - v2.4.2</h2></div>
<div class="tsd-panel tsd-typography"><p><a href="https://www.npmjs.com/package/ts-lambda-api"><img src="https://img.shields.io/npm/v/ts-lambda-api.svg?style=flat-square" alt="npm"></a> <a href="https://travis-ci.com/djfdyuruiry/ts-lambda-api"><img src="https://img.shields.io/npm/dw/ts-lambda-api.svg?style=flat-square" alt="downloads"></a></p>
<p><a href="https://github.com/djfdyuruiry/ts-lambda-api/actions/workflows/build.yml"><img src="https://img.shields.io/github/actions/workflow/status/djfdyuruiry/ts-lambda-api/build.yml" alt="GitHub Workflow Status (with event)"></a> <a href="https://libraries.io/npm/ts-lambda-api"><img src="https://img.shields.io/librariesio/github/djfdyuruiry/ts-lambda-api" alt="Libraries.io dependency status for GitHub repo"></a></p>
<a id="md:ts-lambda-api" class="tsd-anchor"></a><h1><a href="#md:ts-lambda-api">ts-lambda-api</a></h1><p>Build REST API&#39;s using Typescript &amp; AWS Lambda.</p>
<p><a href="https://github.com/djfdyuruiry/ts-lambda-api/">GitHub Repo</a></p>
<p><a href="https://nodei.co/npm/ts-lambda-api/"><img src="https://nodei.co/npm/ts-lambda-api.png" alt="NPM"></a></p>
<p>Read the full <code>typedoc</code> documentation: <a href="https://djfdyuruiry.github.io/ts-lambda-api/">https://djfdyuruiry.github.io/ts-lambda-api/</a></p>
<p>Framework Features:</p>
<ul>
<li>Decorator based routing for API controllers and endpoint methods</li>
<li>Decorator based parameter binding for endpoint methods (from body, path &amp; query parameters and headers)</li>
<li>API controller dependency injection using <a href="https://github.com/inversify/InversifyJS">InversifyJS</a></li>
<li>Supports invoking your API from both <code>Amazon API Gateway</code> and <code>Amazon Load Balancer</code></li>
<li>Out of the box OpenAPI spec (v3) generation support</li>
<li>Built in support for applying JSON patch operations</li>
</ul>
<p>This project is built on top of the wonderful <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> framework.</p>
<p><em>Note: this project uses version 3 of the AWS SDK for certain features</em></p>
<p><strong>Quickstart</strong></p>
<ul>
<li><a href="#create-api">Creating a new API</a></li>
<li><a href="#aws-deploy">Deploy to AWS Lambda</a><ul>
<li><a href="#invoke-lambda">Invoke AWS Lambda</a></li>
</ul>
</li>
</ul>
<p><strong>Docs</strong></p>
<ul>
<li><a href="#routing">Routing</a><ul>
<li><a href="#controller-routes">Controller Routes</a></li>
<li><a href="#endpoint-routes">Endpoint Routes</a></li>
<li><a href="#path-params">Path Parameters</a></li>
<li><a href="#loading-controllers">Manually Loading Controllers</a></li>
</ul>
</li>
<li><a href="#request-binding">Request Parameter Binding</a></li>
<li><a href="#responses">Responses</a></li>
<li><a href="#auth-authorization">Authentication &amp; Authorization</a><ul>
<li><a href="#auth-princ">Authentication and Principals</a></li>
<li><a href="#basic-auth">Basic Authentication</a></li>
<li><a href="#endpoint-princip">Access Principal Context</a></li>
<li><a href="#no-auth-endpoints">Unauthenticated Endpoints</a></li>
<li><a href="#custom-auth">Custom Authentication</a></li>
<li><a href="#authorization">Authorization</a></li>
</ul>
</li>
<li><a href="#errors">Error Handling</a><ul>
<li><a href="#error-interceptors">Error Interceptors</a></li>
<li><a href="#manual-error-interceptors">Manual Error Interceptors</a></li>
<li><a href="#catching-errors">Catching Errors</a></li>
<li><a href="#framework-errors">Framework Error Handling</a></li>
</ul>
</li>
<li><a href="#json-patch">JSON Patch Requests</a></li>
<li><a href="#req-res-context">Request / Response Context</a><ul>
<li><a href="#extend-controller">Extending Controller Class</a></li>
<li><a href="#use-decorators">Using Decorators</a></li>
<li><a href="#send-files">Returning Files in a Response</a></li>
</ul>
</li>
<li><a href="#di">Dependency Injection</a></li>
<li><a href="#config">Configuration</a><ul>
<li><a href="#lambda-api-config">lambda-api</a></li>
<li><a href="#config-reference">Reference</a></li>
</ul>
</li>
<li><a href="#logging">Logging</a><ul>
<li><a href="#logging-writing">Writing Logs</a></li>
<li><a href="#logging-api">API</a></li>
<li><a href="#lambda-api-logging">lambda-api</a></li>
</ul>
</li>
<li><a href="#open-api">OpenAPI (Swagger)</a><ul>
<li><a href="#open-api-decorators">Decorators</a></li>
<li><a href="#open-api-yaml">YAML Support</a></li>
<li><a href="#open-api-auth">Authentication</a></li>
</ul>
</li>
<li><a href="#testing">Testing</a></li>
<li><a href="#dev">Development</a></li>
</ul>
<a id="md:creating-a-new-api" class="tsd-anchor"></a><h2><a href="#md:creating-a-new-api"><a id="create-api"></a>Creating a new API</a></h2><p>This is a short guide to creating your first API using <code>ts-lambda-api</code>. It is somewhat opinionated about project structure, but most of this can be easily customized.</p>
<p><strong>Note: Node.js v18.x &amp; Typescript v5.x are recommended. Other versions may work perfectly fine, but have not been tested.</strong></p>
<ul>
<li><p>Create a directory for your project and run <code>npm init</code> to create your <code>package.json</code></p>
</li>
<li><p>Install required packages:</p>
</li>
</ul>
<pre><code class="language-shell"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">ts-lambda-api</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">-D</span><span class="hl-1"> </span><span class="hl-2">typescript</span><span class="hl-1"> </span><span class="hl-2">@types/node</span><span class="hl-1"> </span><span class="hl-2">@aws-sdk/client-s3</span><span class="hl-1"> </span><span class="hl-2">@aws-sdk/s3-request-presigner</span>
</code><button>Copy</button></pre>
<ul>
<li>Open <code>package.json</code> and add a script to enable access to the Typescript compiler:</li>
</ul>
<pre><code class="language-json"><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;scripts&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;tsc&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;tsc&quot;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ul>
<li>Create a new file named <code>tsconfig.json</code>, add the following:</li>
</ul>
<pre><code class="language-json"><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;compilerOptions&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;module&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;commonjs&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;moduleResolution&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;node&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;emitDecoratorMetadata&quot;</span><span class="hl-1">: </span><span class="hl-3">true</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;experimentalDecorators&quot;</span><span class="hl-1">: </span><span class="hl-3">true</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;strict&quot;</span><span class="hl-1">: </span><span class="hl-3">false</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;baseUrl&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;outDir&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;dist&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;paths&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">            </span><span class="hl-4">&quot;*&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">                </span><span class="hl-2">&quot;node_modules/*&quot;</span><br/><span class="hl-1">            ]</span><br/><span class="hl-1">        },</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;target&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;es2017&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-4">&quot;lib&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;es2017&quot;</span><br/><span class="hl-1">        ]</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;include&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">        </span><span class="hl-2">&quot;src/**/*&quot;</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><strong>Note: <code>emitDecoratorMetadata</code>, <code>experimentalDecorators</code> and <code>strict</code> flags are required to be set as shown above to compile your app</strong></p>
<ul>
<li><p>Create a new directory named <code>src</code></p>
</li>
<li><p>Create a new file named <code>src/api.ts</code>, add the following:</p>
</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-3">*</span><span class="hl-1"> </span><span class="hl-5">as</span><span class="hl-1"> </span><span class="hl-6">path</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;path&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">AppConfig</span><span class="hl-1">, </span><span class="hl-6">ApiLambdaApp</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appConfig</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">AppConfig</span><span class="hl-1">()</span><br/><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">base</span><span class="hl-1"> = </span><span class="hl-2">&quot;/api/v1&quot;</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">version</span><span class="hl-1"> = </span><span class="hl-2">&quot;v1&quot;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">controllersPath</span><span class="hl-1"> = [</span><span class="hl-6">path</span><span class="hl-1">.</span><span class="hl-0">join</span><span class="hl-1">(</span><span class="hl-6">__dirname</span><span class="hl-1">, </span><span class="hl-2">&quot;controllers&quot;</span><span class="hl-1">)]</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">handler</span><span class="hl-1">(</span><span class="hl-6">event</span><span class="hl-1">, </span><span class="hl-6">context</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-6">event</span><span class="hl-1">, </span><span class="hl-6">context</span><span class="hl-1">)</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ul>
<li><p>Add a <code>src/controllers</code> directory</p>
</li>
<li><p>Create a new file in <code>controllers</code> named <code>HelloWorldController.ts</code>, add the following:</p>
</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">Controller</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">() </span><span class="hl-8">// all controller classes must be decorated with injectable</span><br/><span class="hl-8">// extending Controller is optional, it provides convenience methods</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">HelloWorldController</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Controller</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// GET, POST, PUT, PATCH and DELETE are supported</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;hello&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-2">&quot;world&quot;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-8">// sub routes can be specified in method decorators</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/sub-resource&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getSubResource</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;hello&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-2">&quot;world&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-2">&quot;sub&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-2">&quot;resource&quot;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ul>
<li>Compile the application by running:</li>
</ul>
<pre><code><span class="hl-6">npm</span><span class="hl-1"> </span><span class="hl-6">run</span><span class="hl-1"> </span><span class="hl-6">tsc</span>
</code><button>Copy</button></pre>
<a id="md:deploy-to-aws-lambda" class="tsd-anchor"></a><h2><a href="#md:deploy-to-aws-lambda"><a id="aws-deploy"></a>Deploy to AWS Lambda</a></h2><p><em><strong>Note</strong>: AWS supplies the <code>aws-sdk</code> package at runtime when running your Lambda applications, so there is no need to include this in your deployment package.</em></p>
<ul>
<li><p>Build your application</p>
</li>
<li><p>Remove dev dependencies from your <code>node_modules</code> directory:</p>
</li>
</ul>
<pre><code><span class="hl-6">rm</span><span class="hl-1"> -</span><span class="hl-6">rf</span><span class="hl-1"> </span><span class="hl-6">node_modules</span><br/><span class="hl-6">npm</span><span class="hl-1"> </span><span class="hl-6">install</span><span class="hl-1"> --</span><span class="hl-6">only</span><span class="hl-1">=</span><span class="hl-6">prod</span>
</code><button>Copy</button></pre>
<p><em>This will <strong>massively</strong> reduce the size of your deployment package</em></p>
<ul>
<li>Run the following commands to package your app:</li>
</ul>
<pre><code class="language-shell"><span class="hl-0">zip</span><span class="hl-1"> </span><span class="hl-3">-r</span><span class="hl-1"> </span><span class="hl-2">dist/lambda.zip</span><span class="hl-1"> </span><span class="hl-2">node_modules</span><br/><span class="hl-0">cd</span><span class="hl-1"> </span><span class="hl-2">dist</span><br/><span class="hl-0">zip</span><span class="hl-1"> </span><span class="hl-3">-r</span><span class="hl-1"> </span><span class="hl-2">lambda.zip</span><span class="hl-1"> </span><span class="hl-2">./</span>
</code><button>Copy</button></pre>
<ul>
<li>Upload your lambda using the <code>dist/lambda.zip</code> file. Specify <code>app.handler</code> as the function handler. See: <a href="https://docs.aws.amazon.com/lambda/latest/dg/nodejs-create-deployment-pkg.html">https://docs.aws.amazon.com/lambda/latest/dg/nodejs-create-deployment-pkg.html</a></li>
</ul>
<a id="md:invoke-lambda" class="tsd-anchor"></a><h3><a href="#md:invoke-lambda"><a id="invoke-lambda"></a>Invoke Lambda</a></h3><ul>
<li><p>Create an AWS Load Balancer and point it to your new API Lambda. See: <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/lambda-functions.html">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/lambda-functions.html</a></p>
</li>
<li><p>You can now call your new ALB to see your API in action:</p>
</li>
</ul>
<pre><code class="language-shell"><span class="hl-0">wget</span><span class="hl-1"> </span><span class="hl-3">-qO</span><span class="hl-1"> </span><span class="hl-2">-</span><span class="hl-1"> </span><span class="hl-2">https://some.alb.dns.address/api/v1/hello-world/</span>
</code><button>Copy</button></pre>
<ul>
<li>You should see:</li>
</ul>
<pre><code class="language-json"><span class="hl-1">{</span><span class="hl-4">&quot;hello&quot;</span><span class="hl-1">:</span><span class="hl-2">&quot;world&quot;</span><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:routing" class="tsd-anchor"></a><h2><a href="#md:routing"><a id="routing"></a>Routing</a></h2><p>Routing is configured using decorators on both controller classes and endpoint methods. You can also define a global base path (e.x. <code>/api/v1</code>) for your API by configuring the <code>base</code> property when passing your app configuration to the <code>ApiLambdaApp</code> class. (See the <code>Creating a new API</code> section)</p>
<a id="md:controller-routes" class="tsd-anchor"></a><h3><a href="#md:controller-routes"><a id="controller-routes"></a>Controller Routes</a></h3><p>You can declare a root path for all methods in a controller using the <code>apiController</code> decorator.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1">, </span><span class="hl-6">POST</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">HelloWorldController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// handle get /hello-world requests</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">POST</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">post</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// handle post /hello-world requests</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:endpoint-routes" class="tsd-anchor"></a><h3><a href="#md:endpoint-routes"><a id="endpoint-routes"></a>Endpoint Routes</a></h3><p>You can declare a path for any given method in a controller when using the endpoint decorators. The <code>apiController</code> decorator is not required on the class to use this form of routing.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/items&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItems</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// handle get /store/items requests</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:path-parameters" class="tsd-anchor"></a><h3><a href="#md:path-parameters"><a id="path-params"></a>Path Parameters</a></h3><p>You can include parameters as part of your routes, when you need to capture parts of the URL.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">pathParam</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItems</span><span class="hl-1">(@</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with id</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>You can also combine controller and endpoint path parameters.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">pathParam</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store/:storeId&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItem</span><span class="hl-1">(@</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;storeId&quot;</span><span class="hl-1">) </span><span class="hl-6">storeId</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, @</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with storeId and id</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><strong>Note all path parameters are passed in as strings, you will need to cast these if required</strong></p>
<a id="md:manually-loading-controllers" class="tsd-anchor"></a><h3><a href="#md:manually-loading-controllers"><a id="loading-controllers"></a>Manually Loading Controllers</a></h3><p>The default IOC app <code>Container</code> enables the <code>autoBindInjectable</code> option. Controllers decorated with
<code>@injectable</code> are dynamically loaded from the required <code>controllersPath</code> directory during 
initialization. However, controllers can be explicitly specified instead of relying on the <code>@injectable</code> 
decoration to dynamically load the controllers from a directory.</p>
<p>Create an IOC <code>Container</code> with the <code>autoBindInjectable</code> option disabled. Bind the desired controller 
classes to the container and pass the instance into the <code>ApiLambdaApp</code> constructor. The <code>controllersPath</code>
parameter is ignored when the custom container&#39;s <code>autoBindInjectable</code> option disabled.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Container</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;inversify&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">ApiLambdaApp</span><span class="hl-1">, </span><span class="hl-6">ApiRequest</span><span class="hl-1">, </span><span class="hl-6">AppConfig</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;ts-lambda-api&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">AppController</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./controllers/AppController&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appConfig</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">AppConfig</span><span class="hl-1">();</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">base</span><span class="hl-1"> = </span><span class="hl-2">&#39;/api/v1&#39;</span><span class="hl-1">;</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">version</span><span class="hl-1"> = </span><span class="hl-2">&#39;v1&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-8">// Bind the controllers to a container instance with @injectable disabled</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appContainer</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Container</span><span class="hl-1">({ </span><span class="hl-6">autoBindInjectable:</span><span class="hl-1"> </span><span class="hl-3">false</span><span class="hl-1"> });</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appController</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">AppController</span><span class="hl-1">();</span><br/><span class="hl-6">appContainer</span><span class="hl-1">.</span><span class="hl-0">bind</span><span class="hl-1">(</span><span class="hl-6">AppController</span><span class="hl-1">).</span><span class="hl-0">toConstantValue</span><span class="hl-1">(</span><span class="hl-6">appController</span><span class="hl-1">);</span><br/><br/><span class="hl-8">// Pass the customer container into the app - controllersPath is ignored</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-3">undefined</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">, </span><span class="hl-6">appContainer</span><span class="hl-1">);</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-0">lambdaHandler</span><span class="hl-1"> = </span><span class="hl-3">async</span><span class="hl-1"> (</span><span class="hl-6">event</span><span class="hl-1">: </span><span class="hl-9">ApiRequest</span><span class="hl-1">, </span><span class="hl-6">context</span><span class="hl-1">: </span><span class="hl-9">any</span><span class="hl-1">) </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">run</span><span class="hl-1">(</span><span class="hl-6">event</span><span class="hl-1">, </span><span class="hl-6">context</span><span class="hl-1">);</span><br/><span class="hl-1">};</span>
</code><button>Copy</button></pre>
<p><strong>Note you do not need to decorate controller classes with <code>@injectable</code> when autoBindInjectable is disabled</strong></p>
<a id="md:request-parameter-binding" class="tsd-anchor"></a><h2><a href="#md:request-parameter-binding"><a id="request-binding"></a>Request Parameter Binding</a></h2><p>Different parts of the HTTP request can be bound to endpoint method parameters using decorators.</p>
<ul>
<li><code>queryParam</code> - Query string parameter</li>
<li><code>header</code> - HTTP header value</li>
<li><code>body</code> - Entity from request body, this will be an object if the request contains JSON, otherwise it will simply be a string</li>
<li><code>rawBody</code> - Entity from request body as a Buffer, containing a string or binary data</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">body</span><span class="hl-1">, </span><span class="hl-6">header</span><span class="hl-1">, </span><span class="hl-6">queryParam</span><span class="hl-1">, </span><span class="hl-6">rawBody</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1">, </span><span class="hl-6">POST</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Thing</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./Thing&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">HelloWorldController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getThingById</span><span class="hl-1">(@</span><span class="hl-0">queryParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with id</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/some/other/route&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getContentType</span><span class="hl-1">(@</span><span class="hl-0">header</span><span class="hl-1">(</span><span class="hl-2">&quot;content-type&quot;</span><span class="hl-1">) </span><span class="hl-6">contentType</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with contentType</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/thing&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">addThing</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">thing</span><span class="hl-1">: </span><span class="hl-9">Thing</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with thing</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/upload-file&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">addThing</span><span class="hl-1">(@</span><span class="hl-6">rawBody</span><span class="hl-1"> </span><span class="hl-6">file</span><span class="hl-1">: </span><span class="hl-9">Buffer</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with file</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:responses" class="tsd-anchor"></a><h2><a href="#md:responses"><a id="responses"></a>Responses</a></h2><p>There are two ways to respond to requests:</p>
<ul>
<li>Return a value from your endpoint method</li>
<li>Use the response context to send a response (see <code>Request / Response Context</code> section below - the context has convenience methods for html, json, files etc.)</li>
</ul>
<p>By default all return values are serialised to JSON in the response body and the <code>content-type</code> response header is set to <code>application/json</code>. To change this you can use the <code>produces</code> and <code>controllerProduces</code> decorators.</p>
<p>Only JSON content types are serialised automatically, all other types simply convert the return value to a string.</p>
<p>To set the response content type for all methods, use <code>controllerProduces</code> on a class.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">controllerProduces</span><span class="hl-1">, </span><span class="hl-6">pathParam</span><span class="hl-1">, </span><span class="hl-6">produces</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Item</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./Item&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store/:storeId&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">controllerProduces</span><span class="hl-1">(</span><span class="hl-2">&quot;application/xml&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItem</span><span class="hl-1">(@</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;storeId&quot;</span><span class="hl-1">) </span><span class="hl-6">storeId</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, @</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">item</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">lookupItem</span><span class="hl-1">(</span><span class="hl-6">storeId</span><span class="hl-1">, </span><span class="hl-6">id</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">serialiseToXml</span><span class="hl-1">(</span><span class="hl-6">item</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">lookupItem</span><span class="hl-1">(</span><span class="hl-6">storeId</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// go get the item from somewhere, db for example</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">serialiseToXml</span><span class="hl-1">(</span><span class="hl-6">item</span><span class="hl-1">: </span><span class="hl-9">Item</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// use 3rd party library to serialise item</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>For an individual method, use <code>produces</code>. This will override <code>controllerProduces</code> for that method, if present on the controller class.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">produces</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/motd&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">MessageOfTheDayController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    @</span><span class="hl-0">produces</span><span class="hl-1">(</span><span class="hl-2">&quot;text/plain&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">(){</span><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-2">&quot;Message of the Day!&quot;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:authentication-amp-authorization" class="tsd-anchor"></a><h2><a href="#md:authentication-amp-authorization"><a id="auth-authorization"></a>Authentication &amp; Authorization</a></h2><p>This framework supports authenticating requests and authorization for controllers and endpoints. It can be used to configure HTTP authentication, token based auth and role based access control (ACLs).</p>
<p>Implementation is heavily inspired by the Dropwizard framework for Java.</p>
<a id="md:authentication-and-principals" class="tsd-anchor"></a><h3><a href="#md:authentication-and-principals"><a id="auth-princ"></a>Authentication and Principals</a></h3><p>Authentication is preformed by filter classes that are executed before invoking an endpoint; all filter classes implement the <code>IAuthFilter</code> interface.</p>
<p>Filters use information from the HTTP request to authenticate the request. If authentication is successful, a filter will return a principal. A principal is a simple class that contains information about the current user/entity that has been granted access to the endpoint.</p>
<p>To use authentication you must implement your own principal by extending the <code>Principal</code> class:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Principal</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreUser</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Principal</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// we will use this later, see the Authorization section</span><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-6">roles</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">[] = []</span><br/><br/><span class="hl-1">    </span><span class="hl-8">// you can define your user model properties in this class</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">constructor</span><span class="hl-1">(</span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">super</span><span class="hl-1">(</span><span class="hl-6">name</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:basic-authentication" class="tsd-anchor"></a><h3><a href="#md:basic-authentication"><a id="basic-auth"></a>Basic Authentication</a></h3><p>HTTP Basic authentication is supported out of the box by the <code>BasicAuthFilter</code> filter abstract class. You extend this class to implement your authentication logic:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">BasicAuthFilter</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">StoreUser</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./StoreUser&quot;</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreAuthFilter</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">BasicAuthFilter</span><span class="hl-1">&lt;</span><span class="hl-9">StoreUser</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-6">StoreAuthFilter</span><span class="hl-1">.</span><span class="hl-6">name</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">authenticate</span><span class="hl-1">(</span><span class="hl-6">basicAuth</span><span class="hl-1">: </span><span class="hl-9">BasicAuth</span><span class="hl-1">): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">StoreUser</span><span class="hl-1"> | </span><span class="hl-9">undefined</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">getUserFromDb</span><span class="hl-1">(</span><span class="hl-6">basicAuth</span><span class="hl-1">.</span><span class="hl-6">username</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">user</span><span class="hl-1"> &amp;&amp; </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">checkUserPasswordHash</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">, </span><span class="hl-6">basicAuth</span><span class="hl-1">.</span><span class="hl-6">password</span><span class="hl-1">)) {</span><br/><span class="hl-1">            </span><span class="hl-8">// returning a principal signals that the request has been authorized</span><br/><span class="hl-1">            </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">user</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">getUserFromDb</span><span class="hl-1">(</span><span class="hl-6">username</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">): </span><span class="hl-9">StoreUser</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-8">// get the user details from a database, if it exists, otherwise we return null/undefined</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">checkUserPasswordHash</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">: </span><span class="hl-9">StoreUser</span><span class="hl-1">, </span><span class="hl-6">password</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">): </span><span class="hl-9">boolean</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-8">// get the user password hash from a database</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>You register your authentication filter when setting up your application instance:</p>
<pre><code class="language-typescript"><span class="hl-8">// build config and controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">authFilter</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">StoreAuthFilter</span><span class="hl-1">()</span><br/><br/><span class="hl-8">// this will protect your endpoints using the auth filter to authenticate requests</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-6">middlewareRegistry</span><span class="hl-1">.</span><span class="hl-0">addAuthFilter</span><span class="hl-1">(</span><span class="hl-6">authFilter</span><span class="hl-1">)</span><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<a id="md:access-principal-context" class="tsd-anchor"></a><h3><a href="#md:access-principal-context"><a id="endpoint-princip"></a>Access Principal Context</a></h3><p>Once a user has been authenticated you can pass the principal instance into the target endpoint. You can do this by adding a <code>principal</code> parameter decorator to your endpoint method.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">pathParam</span><span class="hl-1">, </span><span class="hl-6">principal</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItem</span><span class="hl-1">(@</span><span class="hl-6">principal</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1">: </span><span class="hl-9">StoreUser</span><span class="hl-1">, @</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// do something with the user context</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:unauthenticated-endpoints" class="tsd-anchor"></a><h3><a href="#md:unauthenticated-endpoints"><a id="no-auth-endpoints"></a>Unauthenticated Endpoints</a></h3><p>There are several situations where you might want to disable authentication for a specific endpoint:</p>
<ul>
<li>Healthcheck / Status endpoint</li>
<li>Login Endpoint</li>
<li>Public API endpoints for unauthenticated users (browsing products without logging in)</li>
</ul>
<p>To do this you need to use the <code>noAuth</code> and <code>controllerNoAuth</code> decorators.</p>
<p>For an endpoint:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">body</span><span class="hl-1">, </span><span class="hl-6">noAuth</span><span class="hl-1">, </span><span class="hl-6">principal</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1">, </span><span class="hl-6">POST</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">LoginRequest</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./LoginRequest&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">StoreUser</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./StoreUser&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/user&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">UserController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/login&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    @</span><span class="hl-6">noAuth</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">login</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">loginRequest</span><span class="hl-1">: </span><span class="hl-9">LoginRequest</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// attempt to log in...</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/profile&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">login</span><span class="hl-1">(@</span><span class="hl-6">principal</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1">: </span><span class="hl-9">StoreUser</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// only authorized users can call this endpoint...</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>For all endpoints in a controller:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">controllerNoAuth</span><span class="hl-1">, </span><span class="hl-6">body</span><span class="hl-1">, </span><span class="hl-6">POST</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">SearchRequest</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./SearchRequest&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/public&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-6">controllerNoAuth</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">PublicController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/search/products&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">searchProducts</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">searchRequest</span><span class="hl-1">: </span><span class="hl-9">SearchRequest</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// I can be called without authentication</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-8">// ...other declared endpoints are also be called without authentication...</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:custom-authentication" class="tsd-anchor"></a><h3><a href="#md:custom-authentication"><a id="custom-auth"></a>Custom Authentication</a></h3><p>If you wish to implement popular authentication mechanisms or make your own, you need to implement the <code>IAuthFilter</code> interface. It accepts two type parameters:</p>
<ul>
<li><code>T</code> - The model class for your authentication data</li>
<li><code>U</code> - A principal class</li>
</ul>
<p>Authentication data classes are free form, for example:</p>
<pre><code class="language-typescript"><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">TokenAuth</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">token</span><span class="hl-1">: </span><span class="hl-9">string</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>Your auth filter implementation must provide a method for extracting your authentication data, and a method that uses that data to authenticate the current request.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Request</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">IAuthFilter</span><span class="hl-1">, </span><span class="hl-6">Principal</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">StoreUser</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./StoreUser&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">TokenAuth</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./TokenAuth&quot;</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">TokenAuthFilter</span><span class="hl-1">&lt;</span><span class="hl-9">T</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Principal</span><span class="hl-1">&gt; </span><span class="hl-3">implements</span><span class="hl-1"> </span><span class="hl-9">IAuthFilter</span><span class="hl-1">&lt;</span><span class="hl-9">TokenAuth</span><span class="hl-1">, </span><span class="hl-9">StoreUser</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-8">// required to be defined for implementations, see:</span><br/><span class="hl-1">    </span><span class="hl-8">//   https://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">authenticationSchemeName</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-2">&quot;Bearer&quot;</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-6">TokenAuthFilter</span><span class="hl-1">.</span><span class="hl-6">name</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">extractAuthData</span><span class="hl-1">(</span><span class="hl-6">request</span><span class="hl-1">: </span><span class="hl-9">Request</span><span class="hl-1">): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">TokenAuth</span><span class="hl-1"> | </span><span class="hl-9">undefined</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">        </span><span class="hl-8">// extract the data if the auth header is present</span><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">request</span><span class="hl-1">.</span><span class="hl-6">headers</span><span class="hl-1">[</span><span class="hl-2">&quot;Authorization&quot;</span><span class="hl-1">]) {</span><br/><span class="hl-1">            </span><span class="hl-5">return</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-6">token:</span><span class="hl-1"> </span><span class="hl-6">request</span><span class="hl-1">.</span><span class="hl-6">headers</span><span class="hl-1">[</span><span class="hl-2">&quot;Authorization&quot;</span><span class="hl-1">]</span><br/><span class="hl-1">            }</span><br/><span class="hl-1">        }</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// if you don&#39;t return any auth data, the request will be marked as unauthorized</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">authenticate</span><span class="hl-1">(</span><span class="hl-6">tokenAuth</span><span class="hl-1">: </span><span class="hl-9">TokenAuth</span><span class="hl-1">): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">StoreUser</span><span class="hl-1"> | </span><span class="hl-9">undefined</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">getUserByTokenFromDb</span><span class="hl-1">(</span><span class="hl-6">tokenAuth</span><span class="hl-1">.</span><span class="hl-6">token</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">user</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">getUserByTokenFromDb</span><span class="hl-1">(</span><span class="hl-6">token</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// get the user for the token and return the user&#39;s details</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>Tip: You can make your class abstract and then make the <code>authenticate</code> method abstract to enable your custom auth filter to be re-usable. This way, you simply extend your custom fiter and implement the authentication logic for your application.</p>
<a id="md:authorization" class="tsd-anchor"></a><h3><a href="#md:authorization"><a id="authorization"></a>Authorization</a></h3><p>To implement role based authorization you implement the <code>IAuthorizer</code> interface.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">IAuthorizer</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">StoreUser</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./StoreUser&quot;</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreAuthorizer</span><span class="hl-1"> </span><span class="hl-3">implements</span><span class="hl-1"> </span><span class="hl-9">IAuthorizer</span><span class="hl-1">&lt;</span><span class="hl-9">StoreUser</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1"> = </span><span class="hl-6">StoreAuthorizer</span><span class="hl-1">.</span><span class="hl-6">name</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">authorize</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">: </span><span class="hl-9">StoreUser</span><span class="hl-1">, </span><span class="hl-6">role</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">): </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">boolean</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">roles</span><span class="hl-1">.</span><span class="hl-0">includes</span><span class="hl-1">(</span><span class="hl-6">role</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>When a user is successfully authenticated by an auth filter, this returns a principal which is passed to the configured authorizer if a resource is marked as restricted. To restrict all endpoints in a controller, use the <code>controllerRolesAllowed</code> decorator:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">controllerRolesAllowed</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">controllerRolesAllowed</span><span class="hl-1">(</span><span class="hl-2">&quot;STORE_GUEST&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;STORE_MANAGER&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItem</span><span class="hl-1">(@</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// this endpoint can only be accessed with principles that are authorized with the STORE_MANAGER role</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>You can restrict a single endpoint using the <code>rolesAllowed</code> decorator:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">rolesAllowed</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    @</span><span class="hl-0">rolesAllowed</span><span class="hl-1">(</span><span class="hl-2">&quot;STORE_MANAGER&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItem</span><span class="hl-1">(@</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// this endpoint can only be accessed with principles that are authorized with the STORE_MANAGER role</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>You can combine both the controller and endpoint decorators for roles. In this case, if endpoint roles are present, they override the controller role set.</p>
<p>You register your authentication filter when setting up your application instance:</p>
<pre><code class="language-typescript"><span class="hl-8">// build config and controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">authorizer</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">StoreAuthorizer</span><span class="hl-1">()</span><br/><br/><span class="hl-8">// this will protect your endpoints using the authorizer to check access roles</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-6">middlewareRegistry</span><span class="hl-1">.</span><span class="hl-0">addAuthorizer</span><span class="hl-1">(</span><span class="hl-6">authorizer</span><span class="hl-1">)</span><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<a id="md:error-handling" class="tsd-anchor"></a><h2><a href="#md:error-handling"><a id="errors"></a>Error Handling</a></h2><p>When an unexpected error is thrown in one of your endpoints, you can choose how to handle this. There are three general techniques:</p>
<ol>
<li>Use an error interceptor</li>
<li>Catch the error in your endpoint logic</li>
<li>Let the framework handle the error</li>
</ol>
<a id="md:error-interceptors" class="tsd-anchor"></a><h3><a href="#md:error-interceptors"><a id="error-interceptors"></a>Error Interceptors</a></h3><p>Error interceptors are classes that can be configured to be invoked when an error occurs when calling a given controller or endpoint. Interceptors extend the <code>ErrorInterceptor</code> class and provide an implementation for an <code>intercept</code> method.</p>
<p>Interceptor instances are built using the InversifyJS app container, so you can add any dependencies as constructor parameters if you configure the container correctly.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">ApiError</span><span class="hl-1">, </span><span class="hl-6">ErrorInterceptor</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreErrorInterceptor</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">ErrorInterceptor</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-0">intercept</span><span class="hl-1">(</span><span class="hl-6">apiError</span><span class="hl-1">: </span><span class="hl-9">ApiError</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// endpointTarget and controllerTarget will set before this is called</span><br/><span class="hl-1">        </span><span class="hl-8">// (they are set to the controller and endpoint that threw the error)</span><br/><span class="hl-1">        </span><span class="hl-6">apiError</span><span class="hl-1">.</span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-10">500</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">statusCode:</span><span class="hl-1"> </span><span class="hl-10">500</span><span class="hl-1">,</span><br/><span class="hl-1">            </span><span class="hl-6">errorMessage:</span><span class="hl-1"> </span><span class="hl-2">&quot;Error getting items for store&quot;</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>In your controller you can then use the <code>controllerErrorInterceptor</code> decorator to specify the error interceptor to use:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">controllerErrorInterceptor</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">StoreErrorInterceptor</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./StoreErrorInterceptor&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">controllerErrorInterceptor</span><span class="hl-1">(</span><span class="hl-6">StoreErrorInterceptor</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/items&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItems</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">getItemsFromDb</span><span class="hl-1">()</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">getItemsFromDb</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// get all the items from the DB, may error</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>You can also use the <code>errorInterceptor</code> decorator on individual endpoints for more fine grained error control. Endpoint interceptors will override controller interceptors.</p>
<a id="md:manual-error-interceptors" class="tsd-anchor"></a><h3><a href="#md:manual-error-interceptors"><a id="manual-error-interceptors"></a>Manual Error Interceptors</a></h3><p>You can manually register interceptors when setting up your application instance:</p>
<pre><code class="language-typescript"><span class="hl-8">// build config and controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">errorInterceptor</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">StoreErrorInterceptor</span><span class="hl-1">()</span><br/><br/><span class="hl-8">// this will intercept errors thrown by any endpoint</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-6">middlewareRegistry</span><span class="hl-1">.</span><span class="hl-0">addErrorInterceptor</span><span class="hl-1">(</span><span class="hl-6">errorInterceptor</span><span class="hl-1">)</span><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<p>You can intercept only the errors thrown by an endpoint by setting <code>endpointTarget</code>:</p>
<pre><code class="language-typescript"><span class="hl-8">// pattern for endpoints is {controller class name}::{endpoint method name}</span><br/><span class="hl-6">errorInterceptor</span><span class="hl-1">.</span><span class="hl-6">endpointTarget</span><span class="hl-1"> = </span><span class="hl-2">&quot;StoreController::getItems&quot;</span>
</code><button>Copy</button></pre>
<p>You can intercept only the errors thrown by a controller by setting <code>controllerTarget</code>:</p>
<pre><code class="language-typescript"><span class="hl-8">// controllers are identified by class name</span><br/><span class="hl-6">errorInterceptor</span><span class="hl-1">.</span><span class="hl-6">controllerTarget</span><span class="hl-1"> = </span><span class="hl-2">&quot;StoreController&quot;</span>
</code><button>Copy</button></pre>
<p><strong>Note: using this type of interceptor is overridden if the target controller or endpoint has an interceptor configured</strong></p>
<a id="md:catching-errors" class="tsd-anchor"></a><h3><a href="#md:catching-errors"><a id="catching-errors"></a>Catching Errors</a></h3><p>You can use a try/catch block and the <code>Response</code> class to handle errors:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">Controller</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Controller</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">(</span><span class="hl-2">&quot;/items&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">getItems</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">getItemsFromDb</span><span class="hl-1">()</span><br/><span class="hl-1">        } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">ex</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-8">// log ex...maybe?</span><br/><br/><span class="hl-1">            </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-10">500</span><span class="hl-1">).</span><span class="hl-0">send</span><span class="hl-1">({</span><br/><span class="hl-1">                </span><span class="hl-6">statusCode:</span><span class="hl-1"> </span><span class="hl-10">500</span><span class="hl-1">,</span><br/><span class="hl-1">                </span><span class="hl-6">errorMessage:</span><span class="hl-1"> </span><span class="hl-2">&quot;Error occurred getting items from backend&quot;</span><br/><span class="hl-1">            })</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">getItemsFromDb</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// get all the items from the DB</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><em>Note: this can also be done by injecting the <code>Response</code> class instance using the <code>response</code> parameter decorator, instead of extending <code>Controller</code>.</em></p>
<a id="md:framework-error-handling" class="tsd-anchor"></a><h3><a href="#md:framework-error-handling"><a id="framework-errors"></a>Framework Error Handling</a></h3><p>If you simply preform your logic in your endpoint method without catching any errors yourself, the framework will catch the error and return a HTTP 500 response with error details. Below is a JSON snippet showing an example.</p>
<pre><code class="language-json"><span class="hl-1">{</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;error&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;...some error that the framework caught when calling an endpoint....&quot;</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:json-patch-requests" class="tsd-anchor"></a><h2><a href="#md:json-patch-requests"><a id="json-patch"></a>JSON Patch Requests</a></h2><p>This library supports <a href="http://jsonpatch.com/">JSON Patch</a> format for updating entities without having to upload the entire entity. To use it in your endpoints, ensure your controller extends the <code>Controller</code> class, an example is below:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">pathParam</span><span class="hl-1">, </span><span class="hl-6">produces</span><span class="hl-1">, </span><span class="hl-6">JsonPatch</span><span class="hl-1">, </span><span class="hl-6">PATCH</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Item</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./Item&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/store&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">StoreController</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Controller</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">PATCH</span><span class="hl-1">(</span><span class="hl-2">&quot;/item/:id&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">modifyItem</span><span class="hl-1">(@</span><span class="hl-0">pathParam</span><span class="hl-1">(</span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">) </span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">, @</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">jsonPatch</span><span class="hl-1">: </span><span class="hl-9">JsonPatch</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">item</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">lookupItem</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// apply the patch operation</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">modifiedItem</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">applyJsonPatch</span><span class="hl-1">&lt;</span><span class="hl-9">Item</span><span class="hl-1">&gt;(</span><span class="hl-6">jsonPatch</span><span class="hl-1">, </span><span class="hl-6">item</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// do something with modifiedItem</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">lookupItem</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-8">// go get the item from somewhere, db for example</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><strong>Under the hood, the API uses the <a href="https://www.npmjs.com/package/fast-json-patch">fast-json-patch</a> package</strong></p>
<a id="md:request--response-context" class="tsd-anchor"></a><h2><a href="#md:request--response-context"><a id="req-res-context"></a>Request / Response Context</a></h2><p>If you want to read request bodies or write to the response, there are several supported approaches.</p>
<a id="md:extending-controller-class" class="tsd-anchor"></a><h3><a href="#md:extending-controller-class"><a id="extend-controller"></a>Extending Controller Class</a></h3><p>If you extend the controller class, you get access to the request and response context.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">Controller</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">HelloWorldController</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Controller</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">queryStringParam</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">request</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">[</span><span class="hl-2">&quot;someField&quot;</span><span class="hl-1">]</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// ... do some logic ...</span><br/><br/><span class="hl-1">        </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">html</span><span class="hl-1">(</span><span class="hl-2">&quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:using-decorators" class="tsd-anchor"></a><h3><a href="#md:using-decorators"><a id="use-decorators"></a>Using Decorators</a></h3><p>You can use parameter decorators to inject the request and response context.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Request</span><span class="hl-1">, </span><span class="hl-6">Response</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">request</span><span class="hl-1">, </span><span class="hl-6">response</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">HelloWorldController</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">(@</span><span class="hl-6">request</span><span class="hl-1"> </span><span class="hl-6">request</span><span class="hl-1">: </span><span class="hl-9">Request</span><span class="hl-1">, @</span><span class="hl-6">response</span><span class="hl-1"> </span><span class="hl-6">response</span><span class="hl-1">: </span><span class="hl-9">Response</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">queryStringParam</span><span class="hl-1"> = </span><span class="hl-6">request</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">[</span><span class="hl-2">&quot;someField&quot;</span><span class="hl-1">]</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// ... do some logic ...</span><br/><br/><span class="hl-1">        </span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">html</span><span class="hl-1">(</span><span class="hl-2">&quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:returning-files-in-a-response" class="tsd-anchor"></a><h3><a href="#md:returning-files-in-a-response"><a id="send-files"></a>Returning Files in a Response</a></h3><p>You can return files by using the <code>sendFile</code> method in the response context.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">Controller</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/files&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">FilesController</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Controller</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">file</span><span class="hl-1">: </span><span class="hl-9">Buffer</span><span class="hl-1"> = </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">getFile</span><span class="hl-1">()</span><br/><br/><span class="hl-1">        </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">sendFile</span><span class="hl-1">(</span><span class="hl-6">file</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">getFile</span><span class="hl-1">(): </span><span class="hl-9">Buffer</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-8">// ... do some logic to get a file Buffer ...</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><strong>The <code>Request</code> and <code>Response</code> classes are documented in the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package.</strong></p>
<a id="md:-dependency-injection" class="tsd-anchor"></a><h2><a href="#md:-dependency-injection"><a id="di"></a> Dependency Injection</a></h2><p>Configuring the IOC container to enable dependency injection for your controllers is easy. Once you build an <code>ApiLambdaApp</code> instance you can call the <code>configureApp</code> method like below:</p>
<pre><code class="language-typescript"><span class="hl-8">// build config and controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">configureApp</span><span class="hl-1">(</span><span class="hl-6">container</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// bind interface to implementation class, for example</span><br/><span class="hl-1">    </span><span class="hl-6">container</span><span class="hl-1">.</span><span class="hl-0">bind</span><span class="hl-1">(</span><span class="hl-6">IMyService</span><span class="hl-1">)</span><br/><span class="hl-1">        .</span><span class="hl-0">to</span><span class="hl-1">(</span><span class="hl-6">MyServiceImplementation</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<p><strong>Note: Any classes that you are going to inject need to be decorated with <code>injectable</code>, any subclasses are also required to be decorated</strong></p>
<p>In your controllers you can then use the registered types as constructor parameters:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">inject</span><span class="hl-1">, </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">IMyService</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./IMyService&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">MyController</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">constructor</span><span class="hl-1">(@</span><span class="hl-0">inject</span><span class="hl-1">(</span><span class="hl-6">IMyService</span><span class="hl-1">) </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">service</span><span class="hl-1">: </span><span class="hl-9">IMyService</span><span class="hl-1">) {</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// use injected service to do cool stuff</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>See the <a href="https://github.com/inversify/InversifyJS">InversifyJS</a> package documentation for full guidance how to use the <code>Container</code> class to manage dependencies.</p>
<a id="md:configuration" class="tsd-anchor"></a><h2><a href="#md:configuration"><a id="config"></a>Configuration</a></h2><p>When building an application instance you pass an <code>AppConfig</code> instance to the constructor. If you want to provide your own application config it is recommended to extend this class .</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">AppConfig</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">DatabaseConfig</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./DatabaseConfig&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">MyCustomConfig</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">AppConfig</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">databaseConfig</span><span class="hl-1">: </span><span class="hl-9">DatabaseConfig</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>You can then configure the IOC container to bind to your configuration instance.</p>
<pre><code class="language-typescript"><span class="hl-8">// build controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appConfig</span><span class="hl-1">: </span><span class="hl-9">MyCustomConfig</span><span class="hl-1"> = </span><span class="hl-0">buildConfig</span><span class="hl-1">()</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">configureApp</span><span class="hl-1">(</span><span class="hl-6">container</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">container</span><span class="hl-1">.</span><span class="hl-0">bind</span><span class="hl-1">(</span><span class="hl-6">MyCustomConfig</span><span class="hl-1">)</span><br/><span class="hl-1">        .</span><span class="hl-0">toConstantValue</span><span class="hl-1">(</span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<p>After which, you can inject your config into your controllers or services.</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">inject</span><span class="hl-1">, </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">MyCustomConfig</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./MyCustomConfig&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/hello-world&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">MyController</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">constructor</span><span class="hl-1">(@</span><span class="hl-0">inject</span><span class="hl-1">(</span><span class="hl-6">MyCustomConfig</span><span class="hl-1">) </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">config</span><span class="hl-1">: </span><span class="hl-9">MyCustomConfig</span><span class="hl-1">) {</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-0">getStuffFromDb</span><span class="hl-1">()</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-0">getStuffFromDb</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// use this.config to configure a database connection</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p><strong>Note: The <code>AppConfig</code> class supports all the configuration fields documented in the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package.</strong></p>
<a id="md:reference" class="tsd-anchor"></a><h3><a href="#md:reference"><a id="config-reference"></a>Reference</a></h3><p>For a complete reference see the <a href="https://djfdyuruiry.github.io/ts-lambda-api/classes/appconfig.html">AppConfig</a> docs.</p>
<a id="md:lambda-api" class="tsd-anchor"></a><h3><a href="#md:lambda-api"><a id="lambda-api-config"></a>lambda-api</a></h3><p>Configuring <code>lambda-api</code> directly can be done by calling the <code>configureApi</code> method like below:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">API</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;lambda-api&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-3">*</span><span class="hl-1"> </span><span class="hl-5">as</span><span class="hl-1"> </span><span class="hl-6">xmljs</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;xml-js&quot;</span><br/><br/><span class="hl-8">// build config and controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">configureApi</span><span class="hl-1">(</span><span class="hl-6">api</span><span class="hl-1">: </span><span class="hl-6">API</span><span class="hl-1"> </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// add middleware handler, for example</span><br/><span class="hl-1">    </span><span class="hl-6">api</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">((</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">, </span><span class="hl-6">next</span><span class="hl-1">) </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-8">// parses any incoming XML data into an object</span><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">headers</span><span class="hl-1">[</span><span class="hl-2">&quot;content-type&quot;</span><span class="hl-1">] === </span><span class="hl-2">&quot;application/xml&quot;</span><span class="hl-1">) {</span><br/><span class="hl-1">            </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1"> = </span><span class="hl-6">xmljs</span><span class="hl-1">.</span><span class="hl-0">xml2json</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, {</span><span class="hl-6">compact:</span><span class="hl-1"> </span><span class="hl-3">true</span><span class="hl-1">})</span><br/><span class="hl-1">        }</span><br/><br/><span class="hl-1">        </span><span class="hl-0">next</span><span class="hl-1">()</span><br/><span class="hl-1">    })</span><br/><span class="hl-1">})</span><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<p><strong>Note: any middleware handlers and manual routes will not apply auth filters, authorizers or error interceptors</strong></p>
<p>See the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package documentation for guidance how to use the <code>API</code> class.</p>
<a id="md:logging" class="tsd-anchor"></a><h2><a href="#md:logging"><a id="logging"></a>Logging</a></h2><p>A logger interface is provided that can write messages to standard out. You can configure this logger using the <code>serverLogging</code> key in the <code>AppConfig</code> class. See the <a href="#config-reference">Config Reference</a> for details on options available. This complements the existing logging provided by <code>lambda-api</code>, which can be configured using the <code>logger</code> key.</p>
<p>By default, the logger is set to <code>info</code> and outputs messages as simple strings.</p>
<p>The format of the messages written out is:</p>
<pre><code><span class="hl-6">level</span><span class="hl-1">  </span><span class="hl-3">class</span><span class="hl-1">                   </span><span class="hl-9">message</span><br/><span class="hl-9">vvvvv</span><span class="hl-1"> </span><span class="hl-9">vvvvvvvv</span><span class="hl-1">   </span><span class="hl-9">vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span><br/><span class="hl-9">INFO</span><span class="hl-1">  </span><span class="hl-9">Endpoint</span><span class="hl-1"> - </span><span class="hl-9">Invoking</span><span class="hl-1"> </span><span class="hl-9">endpoint</span><span class="hl-1">: [</span><span class="hl-9">GET</span><span class="hl-1">] /</span><span class="hl-9">open</span><span class="hl-1">-</span><span class="hl-9">api</span><span class="hl-1">.</span><span class="hl-9">yml</span>
</code><button>Copy</button></pre>
<p>Below is some example output, include a stack trace from an <code>Error</code> instance:</p>
<pre><code><span class="hl-7">INFO</span><span class="hl-1"> </span><span class="hl-6">ApiLambdaApp</span><span class="hl-1"> - </span><span class="hl-6">Received</span><span class="hl-1"> </span><span class="hl-6">event</span><span class="hl-1">, </span><span class="hl-6">initializing</span><span class="hl-1"> </span><span class="hl-6">controllers</span><span class="hl-1"> </span><span class="hl-6">and</span><span class="hl-1"> </span><span class="hl-6">processing</span><span class="hl-1"> </span><span class="hl-6">event</span><br/><span class="hl-7">INFO</span><span class="hl-1"> </span><span class="hl-6">Server</span><span class="hl-1"> - </span><span class="hl-6">Processing</span><span class="hl-1"> </span><span class="hl-7">API</span><span class="hl-1"> </span><span class="hl-6">request</span><span class="hl-1"> </span><span class="hl-6">event</span><span class="hl-1"> </span><span class="hl-6">for</span><span class="hl-1"> </span><span class="hl-11">path</span><span class="hl-1">:</span><span class="hl-12"> /test/</span><br/><span class="hl-7">INFO</span><span class="hl-1"> </span><span class="hl-6">Endpoint</span><span class="hl-1"> - [</span><span class="hl-7">GET</span><span class="hl-1">] /</span><span class="hl-6">test</span><span class="hl-1"> - </span><span class="hl-6">Authenticating</span><span class="hl-1"> </span><span class="hl-6">request</span><br/><span class="hl-7">ERROR</span><span class="hl-1"> </span><span class="hl-6">Endpoint</span><span class="hl-1"> - [</span><span class="hl-7">GET</span><span class="hl-1">] /</span><span class="hl-6">test</span><span class="hl-1"> - </span><span class="hl-6">Error</span><span class="hl-1"> </span><span class="hl-6">processing</span><span class="hl-1"> </span><span class="hl-6">endpoint</span><span class="hl-1"> </span><span class="hl-6">request</span><br/><span class="hl-11">Error</span><span class="hl-1">: </span><span class="hl-6">authenticate</span><span class="hl-1"> </span><span class="hl-6">failed</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">TestAuthFilter</span><span class="hl-1">.</span><span class="hl-0">authenticate</span><span class="hl-1"> (/</span><span class="hl-6">home</span><span class="hl-1">/</span><span class="hl-6">matthew</span><span class="hl-1">/</span><span class="hl-6">src</span><span class="hl-1">/</span><span class="hl-6">ts</span><span class="hl-1">/</span><span class="hl-6">ts</span><span class="hl-1">-</span><span class="hl-6">lambda</span><span class="hl-1">-</span><span class="hl-6">api</span><span class="hl-1">/</span><span class="hl-6">tests</span><span class="hl-1">/</span><span class="hl-6">src</span><span class="hl-1">/</span><span class="hl-6">test</span><span class="hl-1">-</span><span class="hl-6">components</span><span class="hl-1">/</span><span class="hl-6">TestAuthFilter</span><span class="hl-1">.</span><span class="hl-6">ts</span><span class="hl-1">:</span><span class="hl-10">25</span><span class="hl-1">:</span><span class="hl-10">19</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">Endpoint</span><span class="hl-1">.</span><span class="hl-0">authenticateRequest</span><span class="hl-1"> (/</span><span class="hl-6">home</span><span class="hl-1">/</span><span class="hl-6">matthew</span><span class="hl-1">/</span><span class="hl-6">src</span><span class="hl-1">/</span><span class="hl-6">ts</span><span class="hl-1">/</span><span class="hl-6">ts</span><span class="hl-1">-</span><span class="hl-6">lambda</span><span class="hl-1">-</span><span class="hl-6">api</span><span class="hl-1">/</span><span class="hl-6">dist</span><span class="hl-1">/</span><span class="hl-6">api</span><span class="hl-1">/</span><span class="hl-6">Endpoint</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">15</span><span class="hl-1">:</span><span class="hl-10">2640</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-0">processTicksAndRejections</span><span class="hl-1"> (</span><span class="hl-6">internal</span><span class="hl-1">/</span><span class="hl-6">process</span><span class="hl-1">/</span><span class="hl-6">task_queues</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">86</span><span class="hl-1">:</span><span class="hl-10">5</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">runNextTicks</span><span class="hl-1"> [</span><span class="hl-5">as</span><span class="hl-1"> </span><span class="hl-9">_tickCallback</span><span class="hl-1">] (</span><span class="hl-6">internal</span><span class="hl-1">/</span><span class="hl-6">process</span><span class="hl-1">/</span><span class="hl-6">task_queues</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">56</span><span class="hl-1">:</span><span class="hl-10">3</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">Function</span><span class="hl-1">.</span><span class="hl-6">Module</span><span class="hl-1">.</span><span class="hl-0">runMain</span><span class="hl-1"> (</span><span class="hl-6">internal</span><span class="hl-1">/</span><span class="hl-6">modules</span><span class="hl-1">/</span><span class="hl-6">cjs</span><span class="hl-1">/</span><span class="hl-6">loader</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">880</span><span class="hl-1">:</span><span class="hl-10">11</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-0">runMain</span><span class="hl-1"> (/</span><span class="hl-6">home</span><span class="hl-1">/</span><span class="hl-6">matthew</span><span class="hl-1">/.</span><span class="hl-6">node</span><span class="hl-1">-</span><span class="hl-6">spawn</span><span class="hl-1">-</span><span class="hl-6">wrap</span><span class="hl-1">-</span><span class="hl-10">13541</span><span class="hl-1">-13</span><span class="hl-6">c0098ec456</span><span class="hl-1">/</span><span class="hl-6">node</span><span class="hl-1">:</span><span class="hl-10">68</span><span class="hl-1">:</span><span class="hl-10">10</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">Function</span><span class="hl-1">.&lt;</span><span class="hl-6">anonymous</span><span class="hl-1">&gt; (/</span><span class="hl-6">home</span><span class="hl-1">/</span><span class="hl-6">matthew</span><span class="hl-1">/.</span><span class="hl-6">node</span><span class="hl-1">-</span><span class="hl-6">spawn</span><span class="hl-1">-</span><span class="hl-6">wrap</span><span class="hl-1">-</span><span class="hl-10">13541</span><span class="hl-1">-13</span><span class="hl-6">c0098ec456</span><span class="hl-1">/</span><span class="hl-6">node</span><span class="hl-1">:</span><span class="hl-10">171</span><span class="hl-1">:</span><span class="hl-10">5</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">.&lt;</span><span class="hl-6">anonymous</span><span class="hl-1">&gt; (/</span><span class="hl-6">home</span><span class="hl-1">/</span><span class="hl-6">matthew</span><span class="hl-1">/</span><span class="hl-6">src</span><span class="hl-1">/</span><span class="hl-6">ts</span><span class="hl-1">/</span><span class="hl-6">ts</span><span class="hl-1">-</span><span class="hl-6">lambda</span><span class="hl-1">-</span><span class="hl-6">api</span><span class="hl-1">/</span><span class="hl-6">node_modules</span><span class="hl-1">/</span><span class="hl-6">nyc</span><span class="hl-1">/</span><span class="hl-6">bin</span><span class="hl-1">/</span><span class="hl-6">wrap</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">23</span><span class="hl-1">:</span><span class="hl-10">4</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">Module</span><span class="hl-1">.</span><span class="hl-0">_compile</span><span class="hl-1"> (</span><span class="hl-6">internal</span><span class="hl-1">/</span><span class="hl-6">modules</span><span class="hl-1">/</span><span class="hl-6">cjs</span><span class="hl-1">/</span><span class="hl-6">loader</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">816</span><span class="hl-1">:</span><span class="hl-10">30</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-6">at</span><span class="hl-1"> </span><span class="hl-6">Object</span><span class="hl-1">.</span><span class="hl-6">Module</span><span class="hl-1">.</span><span class="hl-6">_extensions</span><span class="hl-1">..</span><span class="hl-0">js</span><span class="hl-1"> (</span><span class="hl-6">internal</span><span class="hl-1">/</span><span class="hl-6">modules</span><span class="hl-1">/</span><span class="hl-6">cjs</span><span class="hl-1">/</span><span class="hl-6">loader</span><span class="hl-1">.</span><span class="hl-6">js</span><span class="hl-1">:</span><span class="hl-10">827</span><span class="hl-1">:</span><span class="hl-10">10</span><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>If you set the <code>format</code> to <code>json</code> the log messages will look like this:</p>
<pre><code class="language-json"><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;level&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;INFO&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;msg&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;Endpoint - Invoking endpoint: [GET] /open-api.yml&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-4">&quot;time&quot;</span><span class="hl-1">: </span><span class="hl-10">1555865906882</span><span class="hl-1"> </span><span class="hl-8">// milliseconds since epoch</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>This format matches the keys used by the <code>lambda-api</code> framework in it&#39;s output.</p>
<a id="md:writing-logs" class="tsd-anchor"></a><h3><a href="#md:writing-logs"><a id="logging-writing"></a>Writing Logs</a></h3><p>To write logs you will ned a logger instance. There are three ways to get one:</p>
<ul>
<li>Extend the <code>Controller</code> class in your controller:</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiController</span><span class="hl-1">, </span><span class="hl-6">Controller</span><span class="hl-1">, </span><span class="hl-6">GET</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">TestController</span><span class="hl-1"> </span><span class="hl-3">extends</span><span class="hl-1"> </span><span class="hl-9">Controller</span><span class="hl-1"> {</span><br/><span class="hl-1">    @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-2">&quot;In GET method!&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-2">&quot;OK&quot;</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ul>
<li>Use a <code>LogFactory</code> instance to build it:</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">inject</span><span class="hl-1">, </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">AppConfig</span><span class="hl-1">, </span><span class="hl-6">LogFactory</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">SomeServiceYouMightMake</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// get your app config using dependency injection</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">constructor</span><span class="hl-1">(@</span><span class="hl-0">inject</span><span class="hl-1">(</span><span class="hl-6">AppConfig</span><span class="hl-1">) </span><span class="hl-3">private</span><span class="hl-1"> </span><span class="hl-3">readonly</span><span class="hl-1"> </span><span class="hl-6">appConfig</span><span class="hl-1">: </span><span class="hl-9">AppConfig</span><span class="hl-1">)</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">doStuff</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">factory</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">LogFactory</span><span class="hl-1">(</span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">logger</span><span class="hl-1"> = </span><span class="hl-6">factory</span><span class="hl-1">.</span><span class="hl-0">getLogger</span><span class="hl-1">(</span><span class="hl-6">SomeServiceYouMightMake</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">debug</span><span class="hl-1">(</span><span class="hl-2">&quot;Inside doStuff!&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<ul>
<li>Use the <code>LogFactory</code> static methods to build it:</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">LogFactory</span><span class="hl-1">, </span><span class="hl-6">LogLevel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">SomeServiceYouMightMake</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">doStuff</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-8">// you can specify the level and format of the log</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">logger</span><span class="hl-1"> = </span><span class="hl-6">LogFactory</span><span class="hl-1">.</span><span class="hl-0">getCustomLogger</span><span class="hl-1">(</span><span class="hl-6">SomeServiceYouMightMake</span><span class="hl-1">, </span><span class="hl-6">LogLevel</span><span class="hl-1">.</span><span class="hl-6">debug</span><span class="hl-1">, </span><span class="hl-2">&quot;json&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">debug</span><span class="hl-1">(</span><span class="hl-2">&quot;Inside doStuff!&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:-server-logger-api" class="tsd-anchor"></a><h3><a href="#md:-server-logger-api"><a id="logging-api"></a> Server Logger API</a></h3><p>The logging API supports formatting of messages using the <a href="https://www.npmjs.com/package/sprintf-js"><code>sprintf-js</code></a> npm module, simply pass in your arguments and put placeholders in your message string:</p>
<pre><code class="language-typescript"><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">warn</span><span class="hl-1">(</span><span class="hl-2">&quot;Hello there %s, how are you?&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;Roy&quot;</span><span class="hl-1">)</span><br/><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">debug</span><span class="hl-1">(</span><span class="hl-2">&quot;Task status: %s. Task data: %j&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;success&quot;</span><span class="hl-1">, {</span><span class="hl-6">event:</span><span class="hl-1"> </span><span class="hl-2">&quot;run batch&quot;</span><span class="hl-1">})</span>
</code><button>Copy</button></pre>
<p>Using this will help to speed up your app if you do a lot of logging, because unnecessary work to convert values to strings and the JSON serialization of debug messages will not take place if a higher log level is set.</p>
<p>Below is an example of the methods available on logger instances:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">LogFactory</span><span class="hl-1">, </span><span class="hl-6">LogLevel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">SomeServiceYouMightMake</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">doStuff</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">logger</span><span class="hl-1"> = </span><span class="hl-6">LogFactory</span><span class="hl-1">.</span><span class="hl-0">getCustomLogger</span><span class="hl-1">(</span><span class="hl-6">SomeServiceYouMightMake</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// different levels</span><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">trace</span><span class="hl-1">(</span><span class="hl-2">&quot;trace&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">fatal</span><span class="hl-1">(</span><span class="hl-2">&quot;fatal&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&quot;error&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// log exceptions with stack traces, also supports formatting of message</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">exception</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Error</span><span class="hl-1">(</span><span class="hl-2">&quot;Bad stuff happened&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">errorWithStack</span><span class="hl-1">(</span><span class="hl-2">&quot;An error occurred somewhere, error code: %d&quot;</span><span class="hl-1">, </span><span class="hl-6">exception</span><span class="hl-1">, </span><span class="hl-10">20000</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// check if a level is enabled</span><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">debugEnabled</span><span class="hl-1">()) {</span><br/><span class="hl-1">            </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">debug</span><span class="hl-1">(</span><span class="hl-2">&quot;Mode #%d&quot;</span><span class="hl-1">, </span><span class="hl-10">355</span><span class="hl-1">)</span><br/><span class="hl-1">        }</span><br/><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">traceEnabled</span><span class="hl-1">()) {</span><br/><span class="hl-1">            </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">trace</span><span class="hl-1">(</span><span class="hl-2">&quot;Sending data: %j&quot;</span><span class="hl-1">, {</span><span class="hl-6">some:</span><span class="hl-1"> {</span><span class="hl-6">payload:</span><span class="hl-1"> </span><span class="hl-10">2345</span><span class="hl-1">}})</span><br/><span class="hl-1">        }</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// check if the logging is currently off (i.e. level is set to `off`)</span><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">isOff</span><span class="hl-1">()) {</span><br/><span class="hl-1">            </span><span class="hl-8">// react to the cruel reality....</span><br/><span class="hl-1">        }</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// pass level in as parameter</span><br/><span class="hl-1">        </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">LogLevel</span><span class="hl-1">.</span><span class="hl-6">info</span><span class="hl-1">, </span><span class="hl-2">&quot;Manual call to the %s method&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;log&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-1">        </span><span class="hl-8">// check if level is enabled using a parameter</span><br/><span class="hl-1">        </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">levelEnabled</span><span class="hl-1">(</span><span class="hl-6">LogLevel</span><span class="hl-1">.</span><span class="hl-6">info</span><span class="hl-1">)) {</span><br/><span class="hl-1">            </span><span class="hl-6">logger</span><span class="hl-1">.</span><span class="hl-0">info</span><span class="hl-1">(</span><span class="hl-2">&quot;I am enabled!&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">        }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<a id="md:lambda-api-1" class="tsd-anchor"></a><h3><a href="#md:lambda-api-1"><a id="lambda-api-logging"></a>lambda-api</a></h3><p>Logging is also provided by the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package, use the <code>AppConfig</code> instance passed to <code>ApiLambdaApp</code> to configure logging using the <code>logger</code> key. See the <a href="#config-reference">Config Reference</a> for details on options available.</p>
<a id="md:openapi-swagger" class="tsd-anchor"></a><h2><a href="#md:openapi-swagger"><a id="open-api"></a>OpenAPI (Swagger)</a></h2><p>The OpenAPI Specification (FKA Swagger) is supported out of the box. If you are not familiar with it, check out <a href="https://github.com/OAI/OpenAPI-Specification">https://github.com/OAI/OpenAPI-Specification</a></p>
<p><strong>This framework supports only OpenAPI v3</strong></p>
<p>The following features are supported:</p>
<ul>
<li>Generating of an OpenAPI Specification, which includes:<ul>
<li>All endpoints with full path and HTTP method</li>
<li>Custom names and descriptions for endpoints</li>
<li>Grouping of endpoints together by API</li>
<li>Endpoint query, path and header parameters (set by parameter decorators)</li>
<li>Response content type headers (set by <code>produces</code> or <code>controllerProduces</code> decorators)</li>
<li>Request and Response bodies: class types, primitive values and files</li>
<li>Response HTTP status codes</li>
<li>HTTP Basic security scheme (when a basic auth filter is configured)</li>
<li>Custom auth filter security schemes</li>
</ul>
</li>
<li>Specification files can be generated in <code>JSON</code> or <code>YAML</code> format (see <a href="#open-api-yaml">YAML Support</a>)</li>
</ul>
<p><em>Note: this framework generates OpenAPI v3.1 compatible specs</em></p>
<p>To enable it, use the <code>openApi</code> property in the <code>AppConfig</code> class when building your app:</p>
<pre><code class="language-typescript"><span class="hl-8">// build controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appConfig</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">AppConfig</span><span class="hl-1">()</span><br/><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">base</span><span class="hl-1"> = </span><span class="hl-2">&quot;/api/v1&quot;</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">version</span><span class="hl-1"> = </span><span class="hl-2">&quot;v1&quot;</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">openApi</span><span class="hl-1">.</span><span class="hl-6">enabled</span><span class="hl-1"> = </span><span class="hl-3">true</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<p>You can then request your specification using the paths:</p>
<ul>
<li><code>/api/v1/open-api.json</code> - JSON format</li>
<li><code>/api/v1/open-api.yml</code> - YAML format</li>
</ul>
<a id="md:decorators" class="tsd-anchor"></a><h3><a href="#md:decorators"><a id="open-api-decorators"></a>Decorators</a></h3><p>To further document your API endpoints you can use OpenAPI decorators.</p>
<ul>
<li><p>Customize the names of APIs and endpoints using <code>api</code>:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">api</span><span class="hl-1">, </span><span class="hl-6">apiController</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/some&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">api</span><span class="hl-1">(</span><span class="hl-2">&quot;Awesome API&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;description of API for doing amazing things&quot;</span><span class="hl-1">) </span><span class="hl-8">// the second parameter is optional</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">SomeController</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-8">// ... endpoints ...</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
</li>
</ul>
<p><em>The same <code>@api</code> name can be used on multiple controllers, meaning you can group by API area rather than controller</em></p>
<ul>
<li><p>Add descriptions to APIs and endpoints using <code>apiOperation</code>:</p>
<pre><code class="language-typescript"><span class="hl-1">@</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;get stuff&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;go get some stuff&quot;</span><span class="hl-1">}) </span><span class="hl-8">// description is optional</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-2">&quot;OK&quot;</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
</li>
<li><p>Describe endpoint request and response content using <code>apiRequest</code> and <code>apiResponse</code>:</p>
<pre><code class="language-typescript"><span class="hl-8">// using model classes</span><br/><span class="hl-1">@</span><span class="hl-0">POST</span><span class="hl-1">()</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({</span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;add stuff&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;go add some stuff&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiRequest</span><span class="hl-1">({</span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">Person</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">201</span><span class="hl-1">, {</span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">Person</span><span class="hl-1">}) </span><span class="hl-8">// each response is associated with a HTTP status code</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">400</span><span class="hl-1">, {</span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">ApiError</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">500</span><span class="hl-1">, {</span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">ApiError</span><span class="hl-1">})</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">post</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">person</span><span class="hl-1">: </span><span class="hl-6">Person</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">person</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// using primitive types (&quot;boolean&quot;, &quot;double&quot;, &quot;int&quot;, &quot;number&quot;, &quot;object&quot; or &quot;string&quot;)</span><br/><span class="hl-1">@</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/plain&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;add some plain stuff&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;plain stuff&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiRequest</span><span class="hl-1">({</span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;int&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">200</span><span class="hl-1">, {</span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;int&quot;</span><span class="hl-1">})</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">postNumber</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">stuff</span><span class="hl-1">: </span><span class="hl-6">number</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">stuff</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// using array types (&quot;array&quot;, &quot;array-array&quot;, &quot;boolean-array&quot;, &quot;double-array&quot;, &quot;int-array&quot;, &quot;number-array&quot;, &quot;object-array&quot; or &quot;string-array&quot;)</span><br/><span class="hl-1">@</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/array&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;add array&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;array time&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiRequest</span><span class="hl-1">({</span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;string-array&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">200</span><span class="hl-1">, {</span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;string-array&quot;</span><span class="hl-1">})</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">postArray</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">stuff</span><span class="hl-1">: </span><span class="hl-6">string</span><span class="hl-1">[]) {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">stuff</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// upload/download files</span><br/><span class="hl-1">@</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/files&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;add file&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;give me a file&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiRequest</span><span class="hl-1">({</span><span class="hl-6">contentType:</span><span class="hl-1"> </span><span class="hl-2">&quot;application/octet-stream&quot;</span><span class="hl-1">, </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;file&quot;</span><span class="hl-1">}) </span><span class="hl-8">// contentType can be used in any request or response definition, inherits controller or endpoint type by default</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">201</span><span class="hl-1">, {</span><span class="hl-6">contentType:</span><span class="hl-1"> </span><span class="hl-2">&quot;application/octet-stream&quot;</span><span class="hl-1">, </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;file&quot;</span><span class="hl-1">})</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">postFile</span><span class="hl-1">(@</span><span class="hl-6">rawBody</span><span class="hl-1"> </span><span class="hl-6">file</span><span class="hl-1">: </span><span class="hl-6">Buffer</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">sendFile</span><span class="hl-1">(</span><span class="hl-6">file</span><span class="hl-1">)</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// providing custom request/response body example</span><br/><span class="hl-1">@</span><span class="hl-0">POST</span><span class="hl-1">(</span><span class="hl-2">&quot;/custom-info&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;add custom stuff&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;go add some custom stuff&quot;</span><br/><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiRequest</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">Person</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">example:</span><span class="hl-1"> </span><span class="hl-2">`{&quot;name&quot;: &quot;some name&quot;, &quot;age&quot;: 22}`</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Details for a person&quot;</span><br/><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">201</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">Person</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">example:</span><span class="hl-1"> </span><span class="hl-2">`{&quot;name&quot;: &quot;another name&quot;, &quot;age&quot;: 30}`</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;Uploaded person information&quot;</span><br/><span class="hl-1">})</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">postCustomInfo</span><span class="hl-1">(@</span><span class="hl-6">body</span><span class="hl-1"> </span><span class="hl-6">person</span><span class="hl-1">: </span><span class="hl-6">Person</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">person</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// no response content, only a status code</span><br/><span class="hl-1">@</span><span class="hl-0">DELETE</span><span class="hl-1">()</span><br/><span class="hl-1">@</span><span class="hl-0">apiOperation</span><span class="hl-1">({</span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;delete stuff&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;go delete some stuff&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">@</span><span class="hl-0">apiResponse</span><span class="hl-1">(</span><span class="hl-10">204</span><span class="hl-1">)</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-3">delete</span><span class="hl-1">() {</span><br/><span class="hl-1">    </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">response</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-10">204</span><span class="hl-1">).</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-2">&quot;&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
</li>
<li><p>Hide controllers or individual endpoints from the documentation with <code>apiIgnoreController</code> and <code>apiIgnore</code>:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">injectable</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;inversify&quot;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">api</span><span class="hl-1">, </span><span class="hl-6">apiController</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiController</span><span class="hl-1">(</span><span class="hl-2">&quot;/private&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">api</span><span class="hl-1">(</span><span class="hl-2">&quot;Private API&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;You can still annotate these&quot;</span><span class="hl-1">)</span><br/><span class="hl-1">@</span><span class="hl-0">apiIgnoreController</span><span class="hl-1">()</span><br/><span class="hl-1">@</span><span class="hl-0">injectable</span><span class="hl-1">()</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">PrivateController</span><span class="hl-1"> {</span><br/><br/><span class="hl-1">  @</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-1">  @</span><span class="hl-0">apiOperation</span><span class="hl-1">({ </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&quot;get stuff&quot;</span><span class="hl-1">, </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;go get some stuff&quot;</span><span class="hl-1">})</span><br/><span class="hl-1">  @</span><span class="hl-0">apiIgnore</span><span class="hl-1">() </span><span class="hl-8">// if you didn&#39;t want to ignore the whole controller</span><br/><span class="hl-1">  </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">() {</span><br/><span class="hl-1">      </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-2">&quot;OK&quot;</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  The class <code>Person</code> is set as the request and response in several of the examples above. To help the framework provide meaningful request and response examples automatically, you must either:</p>
<ol>
<li>Provide a public static <code>example</code> method in your class, which will be called if found when generating an API spec. (recommended)</li>
</ol>
<pre><code class="language-typescript"><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">Person</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-9">string</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">age</span><span class="hl-1">: </span><span class="hl-9">number</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">roles</span><span class="hl-1">?: </span><span class="hl-9">string</span><span class="hl-1">[]</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">static</span><span class="hl-1"> </span><span class="hl-0">example</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">person</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Person</span><span class="hl-1">()</span><br/><br/><span class="hl-1">        </span><span class="hl-6">person</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> = </span><span class="hl-2">&quot;name&quot;</span><br/><span class="hl-1">        </span><span class="hl-6">person</span><span class="hl-1">.</span><span class="hl-6">age</span><span class="hl-1"> = </span><span class="hl-10">18</span><br/><span class="hl-1">        </span><span class="hl-6">person</span><span class="hl-1">.</span><span class="hl-6">roles</span><span class="hl-1"> = [</span><span class="hl-2">&quot;role1&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;role2&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;roleN&quot;</span><span class="hl-1">]</span><br/><br/><span class="hl-1">        </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">person</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  -OR-</p>
<ol start="2">
<li>Populate your instance in it&#39;s constructor with some non null/undefined values.</li>
</ol>
<pre><code class="language-typescript"><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">Person</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">: </span><span class="hl-9">string</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">age</span><span class="hl-1">: </span><span class="hl-9">number</span><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-6">roles</span><span class="hl-1">?: </span><span class="hl-9">string</span><span class="hl-1">[]</span><br/><br/><span class="hl-1">    </span><span class="hl-3">public</span><span class="hl-1"> </span><span class="hl-3">constructor</span><span class="hl-1">() {</span><br/><span class="hl-1">        </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1"> = </span><span class="hl-2">&quot;&quot;</span><br/><span class="hl-1">        </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">age</span><span class="hl-1"> = </span><span class="hl-10">0</span><br/><span class="hl-1">        </span><span class="hl-3">this</span><span class="hl-1">.</span><span class="hl-6">roles</span><span class="hl-1"> = []</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  <em>This is required because object properties are not defined until a value is assigned, which makes any sort of reflection impossible.</em></p>
</li>
<li><p>Describe the path, query and header parameters consumed by your endpoints:</p>
<pre><code class="language-typescript"><span class="hl-8">// the below uses the same options used to describe api requests and responses</span><br/><span class="hl-1">@</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">get</span><span class="hl-1">(</span><br/><span class="hl-1">    @</span><span class="hl-0">queryParam</span><span class="hl-1">(</span><span class="hl-2">&quot;param&quot;</span><span class="hl-1">, { </span><span class="hl-6">description:</span><span class="hl-1"> </span><span class="hl-2">&quot;whatever you like&quot;</span><span class="hl-1">, </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;int&quot;</span><span class="hl-1"> }) </span><span class="hl-6">param</span><span class="hl-1">: </span><span class="hl-6">string</span><br/><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-8">// remember, defining a type does not affect the parameter type, will always be a string</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">param</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// You can mark query and header params as required or not,</span><br/><span class="hl-8">// path parameters are always set to required.</span><br/><span class="hl-1">@</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">getAnotherThing</span><span class="hl-1">(</span><br/><span class="hl-1">    @</span><span class="hl-0">header</span><span class="hl-1">(</span><span class="hl-2">&quot;x-param&quot;</span><span class="hl-1">, { </span><span class="hl-6">required:</span><span class="hl-1"> </span><span class="hl-3">true</span><span class="hl-1"> }) </span><span class="hl-6">param</span><span class="hl-1">: </span><span class="hl-6">string</span><br/><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-8">// remember, defining required will not perform any validation, null/undefined will</span><br/><span class="hl-1">    </span><span class="hl-8">// still be passed if the parameter is missing from the request</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">param</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// When expecting an object/array, you can pass in the</span><br/><span class="hl-8">// expected formatting style.</span><br/><span class="hl-8">//</span><br/><span class="hl-8">// For help with the `style` field, see: https://swagger.io/docs/specification/serialization/</span><br/><span class="hl-1">@</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">getAnotherThing</span><span class="hl-1">(</span><br/><span class="hl-1">    @</span><span class="hl-0">queryParam</span><span class="hl-1">(</span><span class="hl-2">&quot;param&quot;</span><span class="hl-1">, { </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;int-array&quot;</span><span class="hl-1">, </span><span class="hl-6">style:</span><span class="hl-1"> </span><span class="hl-2">&quot;pipeDelimited&quot;</span><span class="hl-1">, </span><span class="hl-6">explode:</span><span class="hl-1"> </span><span class="hl-3">false</span><span class="hl-1"> }) </span><span class="hl-6">param</span><span class="hl-1">: </span><span class="hl-6">string</span><br/><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-8">// we would expect param to be passed in the query string as &#39;param=1|2|3|4&#39;</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">param</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-8">// you can specify a content type if the string is expected to be JSON etc.</span><br/><span class="hl-1">@</span><span class="hl-0">GET</span><span class="hl-1">()</span><br/><span class="hl-6">public</span><span class="hl-1"> </span><span class="hl-0">getHeaderTest</span><span class="hl-1">(</span><br/><span class="hl-1">    @</span><span class="hl-0">header</span><span class="hl-1">(</span><span class="hl-2">&quot;x-custom-header&quot;</span><span class="hl-1">, { </span><span class="hl-6">class:</span><span class="hl-1"> </span><span class="hl-6">Person</span><span class="hl-1">, </span><span class="hl-6">contentType:</span><span class="hl-1"> </span><span class="hl-2">&quot;application/json&quot;</span><span class="hl-1"> }) </span><span class="hl-6">customHeader</span><span class="hl-1">: </span><span class="hl-6">string</span><br/><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-3">let</span><span class="hl-1"> </span><span class="hl-6">person</span><span class="hl-1">: </span><span class="hl-9">Person</span><span class="hl-1"> = </span><span class="hl-7">JSON</span><span class="hl-1">.</span><span class="hl-0">parse</span><span class="hl-1">(</span><span class="hl-6">customHeader</span><span class="hl-1">)</span><br/><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">person</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  <em>Path parameters support the following styles: simple, label, matrix</em></p>
<p>  <em>Header parameters only support the &#39;simple&#39; style</em></p>
</li>
<li><p>Add security schemes to your specification (other than Basic auth, this is automatically detected) using an <code>apiSecurity</code> decorator on your authentication filter:</p>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">apiSecurity</span><span class="hl-1">, </span><span class="hl-6">IAuthFilter</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;ts-lambda-api&quot;</span><br/><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">User</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&quot;./User&quot;</span><br/><br/><span class="hl-1">@</span><span class="hl-0">apiSecurity</span><span class="hl-1">(</span><span class="hl-2">&quot;bearerAuth&quot;</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-6">type:</span><span class="hl-1"> </span><span class="hl-2">&quot;http&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">scheme:</span><span class="hl-1"> </span><span class="hl-2">&quot;bearer&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-6">bearerFormat:</span><span class="hl-1"> </span><span class="hl-2">&quot;JWT&quot;</span><br/><span class="hl-1">})</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-3">class</span><span class="hl-1"> </span><span class="hl-9">CustomAuthFilter</span><span class="hl-1"> </span><span class="hl-3">implements</span><span class="hl-1"> </span><span class="hl-9">IAuthFilter</span><span class="hl-1">&lt;</span><span class="hl-9">string</span><span class="hl-1">, </span><span class="hl-9">User</span><span class="hl-1">&gt; {</span><br/><span class="hl-1">    </span><span class="hl-8">// ... implementation ...</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>  This decorator uses the <code>SecuritySchemeObject</code> class from the <code>openapi3-ts</code> library to describe the security scheme in place. See the source for more information on using this class: <a href="https://github.com/metadevpro/openapi3-ts/blob/11ec4e394c1c40b3ad44a5cfbf3aa1a847fdb11e/src/model/openapi31.ts#L351">SecuritySchemeObject source</a></p>
</li>
</ul>
<a id="md:yaml-support" class="tsd-anchor"></a><h3><a href="#md:yaml-support"><a id="open-api-yaml"></a>YAML Support</a></h3><p>For <code>YAML</code> specification support, you need to install the following packages in your project:</p>
<pre><code class="language-bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">js-yaml</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">-D</span><span class="hl-1"> </span><span class="hl-2">@types/js-yaml</span>
</code><button>Copy</button></pre>
<a id="md:authentication" class="tsd-anchor"></a><h3><a href="#md:authentication"><a id="open-api-auth"></a>Authentication</a></h3><p>By default the OpenAPI endpoints do not require authentication. If you wish to apply auth filters when a request is made for a spec, set the <code>useAuthentication</code> key in the <code>openApi</code> config:</p>
<pre><code class="language-typescript"><span class="hl-8">// build controllers path...</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">appConfig</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">AppConfig</span><span class="hl-1">()</span><br/><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">base</span><span class="hl-1"> = </span><span class="hl-2">&quot;/api/v1&quot;</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">version</span><span class="hl-1"> = </span><span class="hl-2">&quot;v1&quot;</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">openApi</span><span class="hl-1">.</span><span class="hl-6">enabled</span><span class="hl-1"> = </span><span class="hl-3">true</span><br/><span class="hl-6">appConfig</span><span class="hl-1">.</span><span class="hl-6">openApi</span><span class="hl-1">.</span><span class="hl-6">useAuthentication</span><span class="hl-1"> = </span><span class="hl-3">true</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">ApiLambdaApp</span><span class="hl-1">(</span><span class="hl-6">controllersPath</span><span class="hl-1">, </span><span class="hl-6">appConfig</span><span class="hl-1">)</span><br/><span class="hl-8">// export handler</span>
</code><button>Copy</button></pre>
<a id="md:testing" class="tsd-anchor"></a><h2><a href="#md:testing"><a id="testing"></a>Testing</a></h2><p>For local dev testing and integration with acceptance tests see the <a href="https://www.npmjs.com/package/ts-lambda-api-local">ts-lambda-api-local</a> package which enables hosting your API using express as a local HTTP server.</p>
<p>Check out this project&#39;s dev dependencies to see what is required to test API code. The <code>tests</code> directory of this repo contains extensive acceptance tests which will show you how to build mock requests and invoke your API endpoints programmatically.</p>
<a id="md:development" class="tsd-anchor"></a><h2><a href="#md:development"><a id="dev"></a>Development</a></h2><p>Contributions are welcome to this package. </p>
<p>Developing this package on your own machine requires a Unix shell, as the build scripts use Bash and Unix shell commands.</p>
<p>For Windows machines please work under Git Bash or WSL.</p>
</div></div>
<div class="col-sidebar">
<div class="page-menu">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)" id="icon-chevronDown"></path></svg>Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="#icon-chevronDown"></use></svg>On This Page</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li>
<ul>
<li><a href="#md:ts-lambda-api"><span>ts-<wbr/>lambda-<wbr/>api</span></a></li>
<li>
<ul>
<li><a href="#md:creating-a-new-api"><span>Creating a new API</span></a></li>
<li><a href="#md:deploy-to-aws-lambda"><span>Deploy to AWS <wbr/>Lambda</span></a></li>
<li>
<ul>
<li><a href="#md:invoke-lambda"><span>Invoke <wbr/>Lambda</span></a></li></ul></li>
<li><a href="#md:routing"><span>Routing</span></a></li>
<li>
<ul>
<li><a href="#md:controller-routes"><span>Controller <wbr/>Routes</span></a></li>
<li><a href="#md:endpoint-routes"><span>Endpoint <wbr/>Routes</span></a></li>
<li><a href="#md:path-parameters"><span>Path <wbr/>Parameters</span></a></li>
<li><a href="#md:manually-loading-controllers"><span>Manually <wbr/>Loading <wbr/>Controllers</span></a></li></ul></li>
<li><a href="#md:request-parameter-binding"><span>Request <wbr/>Parameter <wbr/>Binding</span></a></li>
<li><a href="#md:responses"><span>Responses</span></a></li>
<li><a href="#md:authentication-amp-authorization"><span>Authentication &amp; <wbr/>Authorization</span></a></li>
<li>
<ul>
<li><a href="#md:authentication-and-principals"><span>Authentication and <wbr/>Principals</span></a></li>
<li><a href="#md:basic-authentication"><span>Basic <wbr/>Authentication</span></a></li>
<li><a href="#md:access-principal-context"><span>Access <wbr/>Principal <wbr/>Context</span></a></li>
<li><a href="#md:unauthenticated-endpoints"><span>Unauthenticated <wbr/>Endpoints</span></a></li>
<li><a href="#md:custom-authentication"><span>Custom <wbr/>Authentication</span></a></li>
<li><a href="#md:authorization"><span>Authorization</span></a></li></ul></li>
<li><a href="#md:error-handling"><span>Error <wbr/>Handling</span></a></li>
<li>
<ul>
<li><a href="#md:error-interceptors"><span>Error <wbr/>Interceptors</span></a></li>
<li><a href="#md:manual-error-interceptors"><span>Manual <wbr/>Error <wbr/>Interceptors</span></a></li>
<li><a href="#md:catching-errors"><span>Catching <wbr/>Errors</span></a></li>
<li><a href="#md:framework-error-handling"><span>Framework <wbr/>Error <wbr/>Handling</span></a></li></ul></li>
<li><a href="#md:json-patch-requests"><span>JSON <wbr/>Patch <wbr/>Requests</span></a></li>
<li><a href="#md:request--response-context"><span>Request / <wbr/>Response <wbr/>Context</span></a></li>
<li>
<ul>
<li><a href="#md:extending-controller-class"><span>Extending <wbr/>Controller <wbr/>Class</span></a></li>
<li><a href="#md:using-decorators"><span>Using <wbr/>Decorators</span></a></li>
<li><a href="#md:returning-files-in-a-response"><span>Returning <wbr/>Files in a <wbr/>Response</span></a></li></ul></li>
<li><a href="#md:-dependency-injection"><span> <wbr/>Dependency <wbr/>Injection</span></a></li>
<li><a href="#md:configuration"><span>Configuration</span></a></li>
<li>
<ul>
<li><a href="#md:reference"><span>Reference</span></a></li>
<li><a href="#md:lambda-api"><span>lambda-<wbr/>api</span></a></li></ul></li>
<li><a href="#md:logging"><span>Logging</span></a></li>
<li>
<ul>
<li><a href="#md:writing-logs"><span>Writing <wbr/>Logs</span></a></li>
<li><a href="#md:-server-logger-api"><span> <wbr/>Server <wbr/>Logger API</span></a></li>
<li><a href="#md:lambda-api-1"><span>lambda-<wbr/>api</span></a></li></ul></li>
<li><a href="#md:openapi-swagger"><span>OpenAPI (<wbr/>Swagger)</span></a></li>
<li>
<ul>
<li><a href="#md:decorators"><span>Decorators</span></a></li>
<li><a href="#md:yaml-support"><span>YAML <wbr/>Support</span></a></li>
<li><a href="#md:authentication"><span>Authentication</span></a></li></ul></li>
<li><a href="#md:testing"><span>Testing</span></a></li>
<li><a href="#md:development"><span>Development</span></a></li></ul></li></ul></li></ul></div></details></div>
<div class="site-menu">
<nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-4"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-namespace)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.33 16V7.24H10.77L13.446 14.74C13.43 14.54 13.41 14.296 13.386 14.008C13.37 13.712 13.354 13.404 13.338 13.084C13.33 12.756 13.326 12.448 13.326 12.16V7.24H14.37V16H12.93L10.266 8.5C10.282 8.692 10.298 8.936 10.314 9.232C10.33 9.52 10.342 9.828 10.35 10.156C10.366 10.476 10.374 10.784 10.374 11.08V16H9.33Z" fill="var(--color-text)"></path></g></svg><span>ts-<wbr/>lambda-<wbr/>api -<wbr/> v2.4.2</span></a>
<ul class="tsd-small-nested-navigation">
<li><a href="enums/LogLevel.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-8"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-enum)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.45 16V7.24H14.49V8.224H10.518V10.936H14.07V11.908H10.518V15.016H14.49V16H9.45Z" fill="var(--color-text)"></path></g></svg><span>Log<wbr/>Level</span></a></li>
<li><a href="classes/ApiApp.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-128"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-class)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M11.898 16.1201C11.098 16.1201 10.466 15.8961 10.002 15.4481C9.53803 15.0001 9.30603 14.3841 9.30603 13.6001V9.64012C9.30603 8.85612 9.53803 8.24012 10.002 7.79212C10.466 7.34412 11.098 7.12012 11.898 7.12012C12.682 7.12012 13.306 7.34812 13.77 7.80412C14.234 8.25212 14.466 8.86412 14.466 9.64012H13.386C13.386 9.14412 13.254 8.76412 12.99 8.50012C12.734 8.22812 12.37 8.09212 11.898 8.09212C11.426 8.09212 11.054 8.22412 10.782 8.48812C10.518 8.75212 10.386 9.13212 10.386 9.62812V13.6001C10.386 14.0961 10.518 14.4801 10.782 14.7521C11.054 15.0161 11.426 15.1481 11.898 15.1481C12.37 15.1481 12.734 15.0161 12.99 14.7521C13.254 14.4801 13.386 14.0961 13.386 13.6001H14.466C14.466 14.3761 14.234 14.9921 13.77 15.4481C13.306 15.8961 12.682 16.1201 11.898 16.1201Z" fill="var(--color-text)"></path></g></svg><span>Api<wbr/>App</span></a></li>
<li><a href="classes/ApiError.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Api<wbr/>Error</span></a></li>
<li><a href="classes/ApiLambdaApp.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Api<wbr/>Lambda<wbr/>App</span></a></li>
<li><a href="classes/ApiRequest.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Api<wbr/>Request</span></a></li>
<li><a href="classes/ApiResponse.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Api<wbr/>Response</span></a></li>
<li><a href="classes/AppConfig.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>App<wbr/>Config</span></a></li>
<li><a href="classes/BasicAuth.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Basic<wbr/>Auth</span></a></li>
<li><a href="classes/BasicAuthFilter.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Basic<wbr/>Auth<wbr/>Filter</span></a></li>
<li><a href="classes/Controller.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Controller</span></a></li>
<li><a href="classes/ErrorInterceptor.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Error<wbr/>Interceptor</span></a></li>
<li><a href="classes/LogFactory.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Log<wbr/>Factory</span></a></li>
<li><a href="classes/MiddlewareRegistry.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Middleware<wbr/>Registry</span></a></li>
<li><a href="classes/OpenApiConfig.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Open<wbr/>Api<wbr/>Config</span></a></li>
<li><a href="classes/Principal.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Principal</span></a></li>
<li><a href="classes/RequestBuilder.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Request<wbr/>Builder</span></a></li>
<li><a href="classes/Server.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Server</span></a></li>
<li><a href="classes/ServerLoggerConfig.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-128"></use></svg><span>Server<wbr/>Logger<wbr/>Config</span></a></li>
<li><a href="interfaces/IAuthFilter.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-256"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-interface)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.51 16V15.016H11.298V8.224H9.51V7.24H14.19V8.224H12.402V15.016H14.19V16H9.51Z" fill="var(--color-text)"></path></g></svg><span>IAuth<wbr/>Filter</span></a></li>
<li><a href="interfaces/IAuthorizer.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-256"></use></svg><span>IAuthorizer</span></a></li>
<li><a href="interfaces/IDictionary.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-256"></use></svg><span>IDictionary</span></a></li>
<li><a href="interfaces/ILogger.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-256"></use></svg><span>ILogger</span></a></li>
<li><a href="types/JsonPatch.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-4194304"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-type-alias)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M11.31 16V8.224H8.91V7.24H14.79V8.224H12.39V16H11.31Z" fill="var(--color-text)"></path></g></svg><span>Json<wbr/>Patch</span></a></li>
<li><a href="types/LogFormat.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4194304"></use></svg><span>Log<wbr/>Format</span></a></li>
<li><a href="functions/DELETE.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-64"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-function)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.39 16V7.24H14.55V8.224H10.446V11.128H14.238V12.112H10.47V16H9.39Z" fill="var(--color-text)"></path></g></svg><span>DELETE</span></a></li>
<li><a href="functions/GET.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>GET</span></a></li>
<li><a href="functions/PATCH.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>PATCH</span></a></li>
<li><a href="functions/POST.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>POST</span></a></li>
<li><a href="functions/PUT.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>PUT</span></a></li>
<li><a href="functions/api.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api</span></a></li>
<li><a href="functions/apiController.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Controller</span></a></li>
<li><a href="functions/apiIgnore.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Ignore</span></a></li>
<li><a href="functions/apiIgnoreController.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Ignore<wbr/>Controller</span></a></li>
<li><a href="functions/apiOperation.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Operation</span></a></li>
<li><a href="functions/apiRequest-1.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Request</span></a></li>
<li><a href="functions/apiResponse-1.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Response</span></a></li>
<li><a href="functions/apiSecurity.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>api<wbr/>Security</span></a></li>
<li><a href="functions/body.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>body</span></a></li>
<li><a href="functions/consumes.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>consumes</span></a></li>
<li><a href="functions/controllerConsumes.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>controller<wbr/>Consumes</span></a></li>
<li><a href="functions/controllerErrorInterceptor.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>controller<wbr/>Error<wbr/>Interceptor</span></a></li>
<li><a href="functions/controllerNoAuth.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>controller<wbr/>No<wbr/>Auth</span></a></li>
<li><a href="functions/controllerProduces.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>controller<wbr/>Produces</span></a></li>
<li><a href="functions/controllerRolesAllowed.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>controller<wbr/>Roles<wbr/>Allowed</span></a></li>
<li><a href="functions/errorInterceptor-1.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>error<wbr/>Interceptor</span></a></li>
<li><a href="functions/header.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>header</span></a></li>
<li><a href="functions/noAuth.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>no<wbr/>Auth</span></a></li>
<li><a href="functions/pathParam.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>path<wbr/>Param</span></a></li>
<li><a href="functions/principal-1.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>principal</span></a></li>
<li><a href="functions/produces.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>produces</span></a></li>
<li><a href="functions/queryParam.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>query<wbr/>Param</span></a></li>
<li><a href="functions/rawBody.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>raw<wbr/>Body</span></a></li>
<li><a href="functions/request.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>request</span></a></li>
<li><a href="functions/response.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>response</span></a></li>
<li><a href="functions/rolesAllowed.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>roles<wbr/>Allowed</span></a></li>
<li><a href="functions/timed.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-64"></use></svg><span>timed</span></a></li></ul></nav></div></div></div>
<div class="tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div></body></html>