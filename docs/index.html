<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ts-lambda-api - v2.2.3</title>
	<meta name="description" content="Documentation for ts-lambda-api - v2.2.3">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">ts-lambda-api - v2.2.3</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>ts-lambda-api - v2.2.3</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p><a href="https://www.npmjs.com/package/ts-lambda-api"><img src="https://img.shields.io/npm/v/ts-lambda-api.svg?style=flat-square" alt="npm"></a> <a href="https://travis-ci.com/djfdyuruiry/ts-lambda-api"><img src="https://img.shields.io/npm/dw/ts-lambda-api.svg?style=flat-square" alt="downloads"></a></p>
				<p><a href="https://travis-ci.com/djfdyuruiry/ts-lambda-api"><img src="https://img.shields.io/travis/com/djfdyuruiry/ts-lambda-api.svg?style=flat-square" alt="build"></a> <a href="https://github.com/djfdyuruiry/ts-lambda-api/network/dependencies"><img src="https://img.shields.io/david/djfdyuruiry/ts-lambda-api.svg?style=flat-square" alt="dependencies"></a></p>
				<a href="#ts-lambda-api" id="ts-lambda-api" style="color: inherit; text-decoration: none;">
					<h1>ts-lambda-api</h1>
				</a>
				<p>Build REST API&#39;s using Typescript &amp; AWS Lambda.</p>
				<p><a href="https://github.com/djfdyuruiry/ts-lambda-api/">GitHub Repo</a></p>
				<p><a href="https://nodei.co/npm/ts-lambda-api/"><img src="https://nodei.co/npm/ts-lambda-api.png" alt="NPM"></a></p>
				<p>Read the full <code>typedoc</code> documentation: <a href="https://djfdyuruiry.github.io/ts-lambda-api/">https://djfdyuruiry.github.io/ts-lambda-api/</a></p>
				<p>Framework Features:</p>
				<ul>
					<li>Decorator based routing for API controllers and endpoint methods</li>
					<li>Decorator based parameter binding for endpoint methods (from body, path &amp; query parameters and headers)</li>
					<li>API controller dependency injection using <a href="https://github.com/inversify/InversifyJS">InversifyJS</a></li>
					<li>Supports invoking your API from both <code>Amazon API Gateway</code> and <code>Amazon Load Balancer</code></li>
					<li>Out of the box OpenAPI spec (v3) generation support</li>
					<li>Built in support for applying JSON patch operations</li>
				</ul>
				<p>This project is built on top of the wonderful <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> framework.</p>
				<hr>
				<p><strong>Quickstart</strong></p>
				<ul>
					<li><a href="#create-api">Creating a new API</a></li>
					<li><a href="#aws-deploy">Deploy to AWS Lambda</a><ul>
							<li><a href="#invoke-lambda">Invoke AWS Lambda</a></li>
						</ul>
					</li>
				</ul>
				<p><strong>Docs</strong></p>
				<ul>
					<li><p><a href="#routing">Routing</a></p>
						<ul>
							<li><a href="#controller-routes">Controller Routes</a></li>
							<li><a href="#endpoint-routes">Endpoint Routes</a></li>
							<li><a href="#path-params">Path Parameters</a></li>
							<li><a href="#loading-controllers">Manually Loading Controllers</a></li>
						</ul>
					</li>
					<li><p><a href="#request-binding">Request Parameter Binding</a></p>
					</li>
					<li><p><a href="#responses">Responses</a></p>
					</li>
					<li><p><a href="#auth-authorization">Authentication &amp; Authorization</a></p>
						<ul>
							<li><a href="#auth-princ">Authentication and Principals</a></li>
							<li><a href="#basic-auth">Basic Authentication</a></li>
							<li><a href="#endpoint-princip">Access Principal Context</a></li>
							<li><a href="#no-auth-endpoints">Unauthenticated Endpoints</a></li>
							<li><a href="#custom-auth">Custom Authentication</a></li>
							<li><a href="#authorization">Authorization</a></li>
						</ul>
					</li>
					<li><p><a href="#errors">Error Handling</a></p>
						<ul>
							<li><a href="#error-interceptors">Error Interceptors</a></li>
							<li><a href="#manual-error-interceptors">Manual Error Interceptors</a></li>
							<li><a href="#catching-errors">Catching Errors</a></li>
							<li><a href="#framework-errors">Framework Error Handling</a></li>
						</ul>
					</li>
					<li><p><a href="#json-patch">JSON Patch Requests</a></p>
					</li>
					<li><p><a href="#req-res-context">Request / Response Context</a></p>
						<ul>
							<li><a href="#extend-controller">Extending Controller Class</a></li>
							<li><a href="#use-decorators">Using Decorators</a></li>
							<li><a href="#send-files">Returning Files in a Response</a></li>
						</ul>
					</li>
					<li><p><a href="#di">Dependency Injection</a></p>
					</li>
					<li><p><a href="#config">Configuration</a></p>
						<ul>
							<li><a href="#lambda-api-config">lambda-api</a></li>
							<li><a href="#config-reference">Reference</a></li>
						</ul>
					</li>
					<li><p><a href="#logging">Logging</a></p>
						<ul>
							<li><a href="#logging-writing">Writing Logs</a></li>
							<li><a href="#logging-api">API</a></li>
							<li><a href="#lambda-api-logging">lambda-api</a></li>
						</ul>
					</li>
					<li><p><a href="#open-api">OpenAPI (Swagger)</a></p>
						<ul>
							<li><a href="#open-api-decorators">Decorators</a></li>
							<li><a href="#open-api-yaml">YAML Support</a></li>
							<li><a href="#open-api-auth">Authentication</a></li>
						</ul>
					</li>
					<li><p><a href="#testing">Testing</a></p>
					</li>
					<li><p><a href="#useful-links">Useful Links</a></p>
					</li>
				</ul>
				<hr>
				<a href="#creating-a-new-api" id="creating-a-new-api" style="color: inherit; text-decoration: none;">
					<h2><a id="create-api"></a>Creating a new API</h2>
				</a>
				<hr>
				<p>This is a short guide to creating your first API using <code>ts-lambda-api</code>. It is somewhat opinionated about project structure, but most of this can be easily customised.</p>
				<p><strong>Note: Node.js v12.x &amp; Typescript v3.x are recommended. Other versions may work perfectly fine, but have not been tested.</strong></p>
				<ul>
					<li><p>Create a directory for your project and run <code>npm init</code> to create your <code>package.json</code></p>
					</li>
					<li><p>Install required packages:</p>
					</li>
				</ul>
				<pre><code class="language-shell"><span style="color: #000000">npm install ts-lambda-api</span>
<span style="color: #000000">npm install -D typescript @types/node aws-sdk</span>
</code></pre>
				<ul>
					<li>Open <code>package.json</code> and add a script to enable access to the Typescript compiler:</li>
				</ul>
				<pre><code class="language-json"><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;scripts&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;tsc&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;tsc&quot;</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<ul>
					<li>Create a new file named <code>tsconfig.json</code>, add the following:</li>
				</ul>
				<pre><code class="language-json"><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;compilerOptions&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;module&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;commonjs&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;moduleResolution&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;node&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;emitDecoratorMetadata&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;experimentalDecorators&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">true</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;strict&quot;</span><span style="color: #000000">: </span><span style="color: #0000FF">false</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;baseUrl&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;.&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;outDir&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;dist&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;paths&quot;</span><span style="color: #000000">: {</span>
<span style="color: #000000">            </span><span style="color: #0451A5">&quot;*&quot;</span><span style="color: #000000">: [</span>
<span style="color: #000000">                </span><span style="color: #A31515">&quot;node_modules/*&quot;</span>
<span style="color: #000000">            ]</span>
<span style="color: #000000">        },</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;target&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;es2017&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #0451A5">&quot;lib&quot;</span><span style="color: #000000">: [</span>
<span style="color: #000000">            </span><span style="color: #A31515">&quot;es2017&quot;</span>
<span style="color: #000000">        ]</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;include&quot;</span><span style="color: #000000">: [</span>
<span style="color: #000000">        </span><span style="color: #A31515">&quot;src/**/*&quot;</span>
<span style="color: #000000">    ]</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>Note: <code>emitDecoratorMetadata</code>, <code>experimentalDecorators</code> and <code>strict</code> flags are required to be set as shown above to compile your app</strong></p>
				<ul>
					<li><p>Create a new directory named <code>src</code></p>
					</li>
					<li><p>Create a new file named <code>src/api.ts</code>, add the following:</p>
					</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #0000FF">*</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #001080">path</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;path&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">AppConfig</span><span style="color: #000000">, </span><span style="color: #001080">ApiLambdaApp</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appConfig</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">AppConfig</span><span style="color: #000000">()</span>

<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">base</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;/api/v1&quot;</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">version</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;v1&quot;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">controllersPath</span><span style="color: #000000"> = [</span><span style="color: #001080">path</span><span style="color: #000000">.</span><span style="color: #795E26">join</span><span style="color: #000000">(</span><span style="color: #001080">__dirname</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;controllers&quot;</span><span style="color: #000000">)]</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #0000FF">function</span><span style="color: #000000"> </span><span style="color: #795E26">handler</span><span style="color: #000000">(</span><span style="color: #001080">event</span><span style="color: #000000">, </span><span style="color: #001080">context</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">run</span><span style="color: #000000">(</span><span style="color: #001080">event</span><span style="color: #000000">, </span><span style="color: #001080">context</span><span style="color: #000000">)</span>
<span style="color: #000000">}</span>
</code></pre>
				<ul>
					<li><p>Add a <code>src/controllers</code> directory</p>
					</li>
					<li><p>Create a new file in <code>controllers</code> named <code>HelloWorldController.ts</code>, add the following:</p>
					</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">Controller</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">() </span><span style="color: #008000">// all controller classes must be decorated with injectable</span>
<span style="color: #008000">// extending Controller is optional, it provides convience methods</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HelloWorldController</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Controller</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// GET, POST, PUT, PATCH and DELETE are supported</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #A31515">&quot;hello&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;world&quot;</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #008000">// sub routes can be specifed in method decorators</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/sub-resource&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getSubResource</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #A31515">&quot;hello&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;world&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #A31515">&quot;sub&quot;</span><span style="color: #001080">:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;resource&quot;</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<ul>
					<li>Compile the application by running:</li>
				</ul>
				<pre><code><span style="color: #001080">npm</span><span style="color: #000000"> </span><span style="color: #001080">run</span><span style="color: #000000"> </span><span style="color: #001080">tsc</span>
</code></pre>
				<hr>
				<a href="#deploy-to-aws-lambda" id="deploy-to-aws-lambda" style="color: inherit; text-decoration: none;">
					<h2><a id="aws-deploy"></a>Deploy to AWS Lambda</h2>
				</a>
				<hr>
				<p><em><strong>Note</strong>: AWS supplies the <code>aws-sdk</code> package at runtime when running your Lambda applications, so there is no need to include this in your deployment package.</em></p>
				<ul>
					<li><p>Build your application</p>
					</li>
					<li><p>Remove dev dependencies from your <code>node_modules</code> directory:</p>
					</li>
				</ul>
				<pre><code><span style="color: #001080">rm</span><span style="color: #000000"> -</span><span style="color: #001080">rf</span><span style="color: #000000"> </span><span style="color: #001080">node_modules</span>
<span style="color: #001080">npm</span><span style="color: #000000"> </span><span style="color: #001080">install</span><span style="color: #000000"> --</span><span style="color: #001080">only</span><span style="color: #000000">=</span><span style="color: #001080">prod</span>
</code></pre>
				<p><em>This will <strong>massively</strong> reduce the size of your deployment package</em></p>
				<ul>
					<li>Run the following commands to package your app:</li>
				</ul>
				<pre><code class="language-shell"><span style="color: #000000">zip -r dist/lambda.zip node_modules</span>
<span style="color: #795E26">cd</span><span style="color: #000000"> dist</span>
<span style="color: #000000">zip -r lambda.zip ./</span>
</code></pre>
				<ul>
					<li>Upload your lambda using the <code>dist/lambda.zip</code> file. Specify <code>app.handler</code> as the function handler. See: <a href="https://docs.aws.amazon.com/lambda/latest/dg/nodejs-create-deployment-pkg.html">https://docs.aws.amazon.com/lambda/latest/dg/nodejs-create-deployment-pkg.html</a></li>
				</ul>
				<hr>
				<a href="#invoke-lambda" id="invoke-lambda" style="color: inherit; text-decoration: none;">
					<h3><a id="invoke-lambda"></a>Invoke Lambda</h3>
				</a>
				<hr>
				<ul>
					<li><p>Create an AWS Load Balancer and point it to your new API Lambda. See: <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/lambda-functions.html">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/lambda-functions.html</a></p>
					</li>
					<li><p>You can now call your new ALB to see your API in action:</p>
					</li>
				</ul>
				<pre><code class="language-shell"><span style="color: #000000">wget -qO - https://some.alb.dns.address/api/v1/hello-world/</span>
</code></pre>
				<ul>
					<li>You should see:</li>
				</ul>
				<pre><code class="language-json"><span style="color: #000000">{</span><span style="color: #0451A5">&quot;hello&quot;</span><span style="color: #000000">:</span><span style="color: #A31515">&quot;world&quot;</span><span style="color: #000000">}</span>
</code></pre>
				<hr>
				<a href="#routing" id="routing" style="color: inherit; text-decoration: none;">
					<h2><a id="routing"></a>Routing</h2>
				</a>
				<hr>
				<p>Routing is configured using decorators on both controller classes and endpoint methods. You can also define a global base path (e.x. <code>/api/v1</code>) for your API by configuring the <code>base</code> property when passing your app configuration to the <code>ApiLambdaApp</code> class. (See the <code>Creating a new API</code> section)</p>
				<a href="#controller-routes" id="controller-routes" style="color: inherit; text-decoration: none;">
					<h3><a id="controller-routes"></a>Controller Routes</h3>
				</a>
				<p>You can declare a root path for all methods in a controller using the <code>apiController</code> decorator.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000">, </span><span style="color: #001080">POST</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HelloWorldController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// handle get /hello-world requests</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">POST</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">post</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// handle post /hello-world requests</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#endpoint-routes" id="endpoint-routes" style="color: inherit; text-decoration: none;">
					<h3><a id="endpoint-routes"></a>Endpoint Routes</h3>
				</a>
				<p>You can declare a path for any given method in a controller when using the endpoint decorators. The <code>apiController</code> decorator is not required on the class to use this form of routing.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/items&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItems</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// handle get /store/items requests</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<hr>
				<a href="#path-parameters" id="path-parameters" style="color: inherit; text-decoration: none;">
					<h3><a id="path-params"></a>Path Parameters</h3>
				</a>
				<p>You can include parameters as part of your routes, when you need to capture parts of the URL.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">pathParam</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItems</span><span style="color: #000000">(@</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with id</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<hr>
				<p>You can also combine controller and endpoint path parameters.</p>
				<hr>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">pathParam</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store/:storeId&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItem</span><span style="color: #000000">(@</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;storeId&quot;</span><span style="color: #000000">) </span><span style="color: #001080">storeId</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">, @</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with storeId and id</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>Note all path parameters are passed in as strings, you will need to cast these if required</strong></p>
				<hr>
				<a href="#manually-loading-controllers" id="manually-loading-controllers" style="color: inherit; text-decoration: none;">
					<h3><a id="loading-controllers"></a>Manually Loading Controllers</h3>
				</a>
				<hr>
				<p>The default IOC app <code>Container</code> enables the <code>autoBindInjectable</code> option. Controllers decorated with
					<code>@injectable</code> are dynamicallly loaded from the required <code>controllersPath</code> directory during
					initialisation. However, controllers can be explicity specified instead of relying on the <code>@injectable</code>
				decoration to dynamically load the controllers from a directory.</p>
				<p>Create an IOC <code>Container</code> with the <code>autoBindInjectable</code> option disabled. Bind the desired controller
					classes to the container and pass the instance into the <code>ApiLambdaApp</code> constructor. The <code>controllersPath</code>
				parameter is ignored when the custom container&#39;s <code>autoBindInjectable</code> option disabled.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Container</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;inversify&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ApiLambdaApp</span><span style="color: #000000">, </span><span style="color: #001080">ApiRequest</span><span style="color: #000000">, </span><span style="color: #001080">AppConfig</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;ts-lambda-api&#039;</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">AppController</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;./controllers/AppController&#039;</span><span style="color: #000000">;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appConfig</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">AppConfig</span><span style="color: #000000">();</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">base</span><span style="color: #000000"> = </span><span style="color: #A31515">&#039;/api/v1&#039;</span><span style="color: #000000">;</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">version</span><span style="color: #000000"> = </span><span style="color: #A31515">&#039;v1&#039;</span><span style="color: #000000">;</span>

<span style="color: #008000">// Bind the controllers to a container instance with @injectable disabled</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appContainer</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Container</span><span style="color: #000000">({ </span><span style="color: #001080">autoBindInjectable:</span><span style="color: #000000"> </span><span style="color: #0000FF">false</span><span style="color: #000000"> });</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appController</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">AppController</span><span style="color: #000000">();</span>
<span style="color: #001080">appContainer</span><span style="color: #000000">.</span><span style="color: #795E26">bind</span><span style="color: #000000">(</span><span style="color: #001080">AppController</span><span style="color: #000000">).</span><span style="color: #795E26">toConstantValue</span><span style="color: #000000">(</span><span style="color: #001080">appController</span><span style="color: #000000">);</span>

<span style="color: #008000">// Pass the customer container into the app - controllersPath is ignored</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #0000FF">undefined</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">, </span><span style="color: #001080">appContainer</span><span style="color: #000000">);</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #795E26">lambdaHandler</span><span style="color: #000000"> = </span><span style="color: #0000FF">async</span><span style="color: #000000"> (</span><span style="color: #001080">event</span><span style="color: #000000">: </span><span style="color: #267F99">ApiRequest</span><span style="color: #000000">, </span><span style="color: #001080">context</span><span style="color: #000000">: </span><span style="color: #267F99">any</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">run</span><span style="color: #000000">(</span><span style="color: #001080">event</span><span style="color: #000000">, </span><span style="color: #001080">context</span><span style="color: #000000">);</span>
<span style="color: #000000">};</span>
</code></pre>
				<p><strong>Note you do not need to decorate controller classes with @injectable when autoBindInjectable is disabled</strong></p>
				<hr>
				<a href="#request-parameter-binding" id="request-parameter-binding" style="color: inherit; text-decoration: none;">
					<h2><a id="request-binding"></a>Request Parameter Binding</h2>
				</a>
				<hr>
				<p>Different parts of the HTTP request can be bound to endpoint method parameters using decorators.</p>
				<ul>
					<li><code>queryParam</code> - Query string parameter</li>
					<li><code>header</code> - HTTP header value</li>
					<li><code>body</code> - Entity from request body, this will be an object if the request contains JSON, otherwise it will simply be a string</li>
					<li><code>rawBody</code> - Entity from request body as a Buffer, containing a string or binary data</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">body</span><span style="color: #000000">, </span><span style="color: #001080">header</span><span style="color: #000000">, </span><span style="color: #001080">queryParam</span><span style="color: #000000">, </span><span style="color: #001080">rawBody</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000">, </span><span style="color: #001080">POST</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Thing</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./Thing&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HelloWorldController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getThingById</span><span style="color: #000000">(@</span><span style="color: #795E26">queryParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with id</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/some/other/route&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getContentType</span><span style="color: #000000">(@</span><span style="color: #795E26">header</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;content-type&quot;</span><span style="color: #000000">) </span><span style="color: #001080">contentType</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with contentType</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/thing&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">addThing</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">thing</span><span style="color: #000000">: </span><span style="color: #267F99">Thing</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with thing</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/upload-file&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">addThing</span><span style="color: #000000">(@</span><span style="color: #001080">rawBody</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000">: </span><span style="color: #267F99">Buffer</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with file</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<hr>
				<a href="#responses" id="responses" style="color: inherit; text-decoration: none;">
					<h2><a id="responses"></a>Responses</h2>
				</a>
				<hr>
				<p>There are two ways to respond to requests:</p>
				<ul>
					<li>Return a value from your endpoint method</li>
					<li>Use the response context to send a response (see <code>Request / Response Context</code> section below - the context has convience methods for html, json, files etc.)</li>
				</ul>
				<p>By default all return values are serialised to JSON in the response body and the <code>content-type</code> response header is set to <code>application/json</code>. To change this you can use the <code>produces</code> and <code>controllerProduces</code> decorators.</p>
				<p>Only JSON content types are serialised automatically, all other types simply convert the return value to a string.</p>
				<p>To set the response content type for all methods, use <code>controllerProduces</code> on a class.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">controllerProduces</span><span style="color: #000000">, </span><span style="color: #001080">pathParam</span><span style="color: #000000">, </span><span style="color: #001080">produces</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Item</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./Item&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store/:storeId&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">controllerProduces</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;application/xml&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItem</span><span style="color: #000000">(@</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;storeId&quot;</span><span style="color: #000000">) </span><span style="color: #001080">storeId</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">, @</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">item</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">lookupItem</span><span style="color: #000000">(</span><span style="color: #001080">storeId</span><span style="color: #000000">, </span><span style="color: #001080">id</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">serialiseToXml</span><span style="color: #000000">(</span><span style="color: #001080">item</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">lookupItem</span><span style="color: #000000">(</span><span style="color: #001080">storeId</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// go get the item from somewhere, db for example</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">serialiseToXml</span><span style="color: #000000">(</span><span style="color: #001080">item</span><span style="color: #000000">: </span><span style="color: #267F99">Item</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// use 3rd party library to serialise item</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>For an individual method, use <code>produces</code>. This will override <code>controllerProduces</code> for that method, if present on the controller class.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">produces</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/motd&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">MessageOfTheDayController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    @</span><span style="color: #795E26">produces</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;text/plain&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">(){</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Message of the Day!&quot;</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<hr>
				<a href="#authentication-amp-authorization" id="authentication-amp-authorization" style="color: inherit; text-decoration: none;">
					<h2><a id="auth-authorization"></a>Authentication &amp; Authorization</h2>
				</a>
				<hr>
				<p>This framework supports authenticating requests and authorization for controllers and endpoints. It can be used to configure HTTP authentication, token based auth and role based access control (ACLs).</p>
				<p>Implementation is heavily inspired by the Dropwizard framework for Java.</p>
				<a href="#authentication-and-principals" id="authentication-and-principals" style="color: inherit; text-decoration: none;">
					<h3><a id="auth-princ"></a>Authentication and Principals</h3>
				</a>
				<p>Authentication is preformed by filter classes that are executed before invoking an endpoint; all filter classes implement the <code>IAuthFilter</code> interface.</p>
				<p>Filters use information from the HTTP request to authenticate the request. If authentication is successful, a filter will return a principal. A principal is a simple class that contains information about the current user/entity that has been granted access to the endpoint.</p>
				<p>To use authentication you must implement your own principal by extending the <code>Principal</code> class:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Principal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreUser</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Principal</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// we will use this later, see the Authorization section</span>
<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #001080">roles</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">[] = []</span>

<span style="color: #000000">    </span><span style="color: #008000">// you can define your user model properties in this class</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">super</span><span style="color: #000000">(</span><span style="color: #001080">name</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#basic-authentication" id="basic-authentication" style="color: inherit; text-decoration: none;">
					<h3><a id="basic-auth"></a>Basic Authentication</h3>
				</a>
				<p>HTTP Basic authentication is supported out of the box by the <code>BasicAuthFilter</code> filter abstract class. You extend this class to implement your authentication logic:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">BasicAuthFilter</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">StoreUser</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./StoreUser&quot;</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreAuthFilter</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">BasicAuthFilter</span><span style="color: #000000">&lt;</span><span style="color: #267F99">StoreUser</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000"> = </span><span style="color: #001080">StoreAuthFilter</span><span style="color: #000000">.</span><span style="color: #001080">name</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">authenticate</span><span style="color: #000000">(</span><span style="color: #001080">basicAuth</span><span style="color: #000000">: </span><span style="color: #267F99">BasicAuth</span><span style="color: #000000">): </span><span style="color: #267F99">Promise</span><span style="color: #000000">&lt;</span><span style="color: #267F99">StoreUser</span><span style="color: #000000"> | </span><span style="color: #267F99">undefined</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">user</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">getUserFromDb</span><span style="color: #000000">(</span><span style="color: #001080">basicAuth</span><span style="color: #000000">.</span><span style="color: #001080">username</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">user</span><span style="color: #000000"> &amp;&amp; </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">checkUserPasswordHash</span><span style="color: #000000">(</span><span style="color: #001080">user</span><span style="color: #000000">, </span><span style="color: #001080">basicAuth</span><span style="color: #000000">.</span><span style="color: #001080">password</span><span style="color: #000000">)) {</span>
<span style="color: #000000">            </span><span style="color: #008000">// returning a principal signals that the request has been authorized</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">user</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">getUserFromDb</span><span style="color: #000000">(</span><span style="color: #001080">username</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">): </span><span style="color: #267F99">StoreUser</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// get the user details from a database, if it exists, otherwise we return null/undefined</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">checkUserPasswordHash</span><span style="color: #000000">(</span><span style="color: #001080">user</span><span style="color: #000000">: </span><span style="color: #267F99">StoreUser</span><span style="color: #000000">, </span><span style="color: #001080">password</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">): </span><span style="color: #267F99">boolean</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// get the user password hash from a database</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>You register your authentication filter when setting up your application instance:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build config and controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">authFilter</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">StoreAuthFilter</span><span style="color: #000000">()</span>

<span style="color: #008000">// this will protect your endpoints using the auth filter to authenticate requests</span>
<span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #001080">middlewareRegistry</span><span style="color: #000000">.</span><span style="color: #795E26">addAuthFilter</span><span style="color: #000000">(</span><span style="color: #001080">authFilter</span><span style="color: #000000">)</span>
<span style="color: #008000">// export handler</span>
</code></pre>
				<a href="#access-principal-context" id="access-principal-context" style="color: inherit; text-decoration: none;">
					<h3><a id="endpoint-princip"></a>Access Principal Context</h3>
				</a>
				<p>Once a user has been authenticated you can pass the principal instance into the target endpoint. You can do this by adding a <code>principal</code> parameter decorator to your endpoint method.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">pathParam</span><span style="color: #000000">, </span><span style="color: #001080">principal</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItem</span><span style="color: #000000">(@</span><span style="color: #001080">principal</span><span style="color: #000000"> </span><span style="color: #001080">user</span><span style="color: #000000">: </span><span style="color: #267F99">StoreUser</span><span style="color: #000000">, @</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// do something with the user context</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#unauthenticated-endpoints" id="unauthenticated-endpoints" style="color: inherit; text-decoration: none;">
					<h3><a id="no-auth-endpoints"></a>Unauthenticated Endpoints</h3>
				</a>
				<p>There are several situations where you might want to disable authentication for a specific endpoint:</p>
				<ul>
					<li>Healthcheck / Status endpoint</li>
					<li>Login Endpoint</li>
					<li>Public API endpoints for unauthenticated users (browsing products without logging in)</li>
				</ul>
				<p>To do this you need to use the <code>noAuth</code> and <code>controllerNoAuth</code> decorators.</p>
				<p>For an endpoint:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">body</span><span style="color: #000000">, </span><span style="color: #001080">noAuth</span><span style="color: #000000">, </span><span style="color: #001080">principal</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000">, </span><span style="color: #001080">POST</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">LoginRequest</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./LoginRequest&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">StoreUser</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./StoreUser&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/user&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">UserController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/login&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    @</span><span style="color: #001080">noAuth</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">login</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">loginRequest</span><span style="color: #000000">: </span><span style="color: #267F99">LoginRequest</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// attempt to log in...</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/profile&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">login</span><span style="color: #000000">(@</span><span style="color: #001080">principal</span><span style="color: #000000"> </span><span style="color: #001080">user</span><span style="color: #000000">: </span><span style="color: #267F99">StoreUser</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// only authorised users can call this endpoint...</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>For all endpoints in a controller:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">controllerNoAuth</span><span style="color: #000000">, </span><span style="color: #001080">body</span><span style="color: #000000">, </span><span style="color: #001080">POST</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">SearchRequest</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./SearchRequest&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/public&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #001080">controllerNoAuth</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">PublicController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/search/products&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">searchProducts</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">searchRequest</span><span style="color: #000000">: </span><span style="color: #267F99">SearchRequest</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// I can be called without authentication</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #008000">// ...other declared endpoints are also be called without authentication...</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#custom-authentication" id="custom-authentication" style="color: inherit; text-decoration: none;">
					<h3><a id="custom-auth"></a>Custom Authentication</h3>
				</a>
				<p>If you wish to implement popular authentication mechanisms or make your own, you need to implement the <code>IAuthFilter</code> interface. It accepts two type parameters:</p>
				<ul>
					<li><code>T</code> - The model class for your authentication data</li>
					<li><code>U</code> - A principal class</li>
				</ul>
				<p>Authentication data classes are free form, for example:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">TokenAuth</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">token</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Your auth filter implementation must provide a method for extracting your authentication data, and a method that uses that data to authenticate the current request.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Request</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">IAuthFilter</span><span style="color: #000000">, </span><span style="color: #001080">Principal</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">StoreUser</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./StoreUser&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">TokenAuth</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./TokenAuth&quot;</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">TokenAuthFilter</span><span style="color: #000000">&lt;</span><span style="color: #267F99">T</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Principal</span><span style="color: #000000">&gt; </span><span style="color: #0000FF">implements</span><span style="color: #000000"> </span><span style="color: #267F99">IAuthFilter</span><span style="color: #000000">&lt;</span><span style="color: #267F99">TokenAuth</span><span style="color: #000000">, </span><span style="color: #267F99">StoreUser</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">    </span><span style="color: #008000">// required to be defined for implementations, see:</span>
<span style="color: #000000">    </span><span style="color: #008000">//   https://www.iana.org/assignments/http-authschemes/http-authschemes.xhtml</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">authenticationSchemeName</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;Bearer&quot;</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000"> = </span><span style="color: #001080">TokenAuthFilter</span><span style="color: #000000">.</span><span style="color: #001080">name</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">extractAuthData</span><span style="color: #000000">(</span><span style="color: #001080">request</span><span style="color: #000000">: </span><span style="color: #267F99">Request</span><span style="color: #000000">): </span><span style="color: #267F99">Promise</span><span style="color: #000000">&lt;</span><span style="color: #267F99">TokenAuth</span><span style="color: #000000"> | </span><span style="color: #267F99">undefined</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">        </span><span style="color: #008000">// extract the data if the auth header is present</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">headers</span><span style="color: #000000">[</span><span style="color: #A31515">&quot;Authorization&quot;</span><span style="color: #000000">]) {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">                </span><span style="color: #001080">token:</span><span style="color: #000000"> </span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">headers</span><span style="color: #000000">[</span><span style="color: #A31515">&quot;Authorization&quot;</span><span style="color: #000000">]</span>
<span style="color: #000000">            }</span>
<span style="color: #000000">        }</span>

<span style="color: #000000">        </span><span style="color: #008000">// if you don&#039;t return any auth data, the request will be marked as unauthorized</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">authenticate</span><span style="color: #000000">(</span><span style="color: #001080">tokenAuth</span><span style="color: #000000">: </span><span style="color: #267F99">TokenAuth</span><span style="color: #000000">): </span><span style="color: #267F99">Promise</span><span style="color: #000000">&lt;</span><span style="color: #267F99">StoreUser</span><span style="color: #000000"> | </span><span style="color: #267F99">undefined</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">user</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">getUserByTokenFromDb</span><span style="color: #000000">(</span><span style="color: #001080">tokenAuth</span><span style="color: #000000">.</span><span style="color: #001080">token</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">user</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">user</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">getUserByTokenFromDb</span><span style="color: #000000">(</span><span style="color: #001080">token</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// get the user for the token and return the user&#039;s details</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>Tip: You can make your class abstract and then make the <code>authenticate</code> method abstract to enable your custom auth filter to be re-usable. This way, you simply extend your custom fiter and implement the authentication logic for your application.</p>
				<a href="#authorization" id="authorization" style="color: inherit; text-decoration: none;">
					<h3><a id="authorization"></a>Authorization</h3>
				</a>
				<p>To implement role based authorization you implement the <code>IAuthorizer</code> interface.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">IAuthorizer</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">StoreUser</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./StoreUser&quot;</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreAuthorizer</span><span style="color: #000000"> </span><span style="color: #0000FF">implements</span><span style="color: #000000"> </span><span style="color: #267F99">IAuthorizer</span><span style="color: #000000">&lt;</span><span style="color: #267F99">StoreUser</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000"> = </span><span style="color: #001080">StoreAuthorizer</span><span style="color: #000000">.</span><span style="color: #001080">name</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">authorize</span><span style="color: #000000">(</span><span style="color: #001080">user</span><span style="color: #000000">: </span><span style="color: #267F99">StoreUser</span><span style="color: #000000">, </span><span style="color: #001080">role</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">): </span><span style="color: #267F99">Promise</span><span style="color: #000000">&lt;</span><span style="color: #267F99">boolean</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">user</span><span style="color: #000000">.</span><span style="color: #001080">roles</span><span style="color: #000000">.</span><span style="color: #795E26">includes</span><span style="color: #000000">(</span><span style="color: #001080">role</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>When a user is successfully authenticated by an auth filter, this returns a principal which is passed to the configured authorizer if a resource is marked as restricted. To restrict all endpoints in a controller, use the <code>controllerRolesAllowed</code> decorator:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">controllerRolesAllowed</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">controllerRolesAllowed</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;STORE_GUEST&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;STORE_MANAGER&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItem</span><span style="color: #000000">(@</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// this endpoint can only be accessed with principles that are authorized with the STORE_MANAGER role</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>You can restrict a single enpoint using the <code>rolesAllowed</code> decorator:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">rolesAllowed</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    @</span><span style="color: #795E26">rolesAllowed</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;STORE_MANAGER&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItem</span><span style="color: #000000">(@</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// this endpoint can only be accessed with principles that are authorized with the STORE_MANAGER role</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>You can combine both the controller and endpoint decorators for roles. In this case, if endpoint roles are present, they override the controller role set.</p>
				<p>You register your authentication filter when setting up your application instance:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build config and controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">authorizer</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">StoreAuthorizer</span><span style="color: #000000">()</span>

<span style="color: #008000">// this will protect your endpoints using the authorizer to check access roles</span>
<span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #001080">middlewareRegistry</span><span style="color: #000000">.</span><span style="color: #795E26">addAuthorizer</span><span style="color: #000000">(</span><span style="color: #001080">authorizer</span><span style="color: #000000">)</span>
<span style="color: #008000">// export handler</span>
</code></pre>
				<hr>
				<a href="#error-handling" id="error-handling" style="color: inherit; text-decoration: none;">
					<h2><a id="errors"></a>Error Handling</h2>
				</a>
				<hr>
				<p>When an unexpected error is thrown in one of your endpoints, you can choose how to handle this. There are three general techniques:</p>
				<ol>
					<li>Use an error interceptor</li>
					<li>Catch the error in your endpoint logic</li>
					<li>Let the framework handle the error</li>
				</ol>
				<a href="#error-interceptors" id="error-interceptors" style="color: inherit; text-decoration: none;">
					<h3><a id="error-interceptors"></a>Error Interceptors</h3>
				</a>
				<p>Error interceptors are classes that can be configured to be invoked when an error occurs when calling a given controller or endpoint. Interceptors extend the <code>ErrorInterceptor</code> class and provide an implementation for an <code>intercept</code> method.</p>
				<p>Interceptor instances are built using the InversifyJS app container, so you can add any dependencies as constructor parameters if you configure the container correctly.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span><span style="color: #000000">;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">ApiError</span><span style="color: #000000">, </span><span style="color: #001080">ErrorInterceptor</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreErrorInterceptor</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">ErrorInterceptor</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">async</span><span style="color: #000000"> </span><span style="color: #795E26">intercept</span><span style="color: #000000">(</span><span style="color: #001080">apiError</span><span style="color: #000000">: </span><span style="color: #267F99">ApiError</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// endpointTarget and controllerTarget will set before this is called</span>
<span style="color: #000000">        </span><span style="color: #008000">// (they are set to the controller and endpoint that threw the error)</span>
<span style="color: #000000">        </span><span style="color: #001080">apiError</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">status</span><span style="color: #000000">(</span><span style="color: #098658">500</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #001080">statusCode:</span><span style="color: #000000"> </span><span style="color: #098658">500</span><span style="color: #000000">,</span>
<span style="color: #000000">            </span><span style="color: #001080">errorMessage:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Error getting items for store&quot;</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>In your controller you can then use the <code>controllerErrorInterceptor</code> decorator to specify the error interceptor to use:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">controllerErrorInterceptor</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">StoreErrorInterceptor</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./StoreErrorInterceptor&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">controllerErrorInterceptor</span><span style="color: #000000">(</span><span style="color: #001080">StoreErrorInterceptor</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/items&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItems</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">getItemsFromDb</span><span style="color: #000000">()</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">getItemsFromDb</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// get all the items from the DB, may error</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>You can also use the <code>errorInterceptor</code> decorator on individual endpoints for more fine grained error control. Endpoint interceptors will override controller interceptors.</p>
				<a href="#manual-error-interceptors" id="manual-error-interceptors" style="color: inherit; text-decoration: none;">
					<h3><a id="manual-error-interceptors"></a>Manual Error Interceptors</h3>
				</a>
				<p>You can manually register interceptors when setting up your application instance:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build config and controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">errorInterceptor</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">StoreErrorInterceptor</span><span style="color: #000000">()</span>

<span style="color: #008000">// this will intercept errors thrown by any endpoint</span>
<span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #001080">middlewareRegistry</span><span style="color: #000000">.</span><span style="color: #795E26">addErrorInterceptor</span><span style="color: #000000">(</span><span style="color: #001080">errorInterceptor</span><span style="color: #000000">)</span>
<span style="color: #008000">// export handler</span>
</code></pre>
				<p>You can intercept only the errors thrown by an endpoint by setting <code>endpointTarget</code>:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// pattern for endpoints is {controller class name}::{endpoint method name}</span>
<span style="color: #001080">errorInterceptor</span><span style="color: #000000">.</span><span style="color: #001080">endpointTarget</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;StoreController::getItems&quot;</span>
</code></pre>
				<p>You can intercept only the errors thrown by a controller by setting <code>controllerTarget</code>:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// controllers are identified by class name</span>
<span style="color: #001080">errorInterceptor</span><span style="color: #000000">.</span><span style="color: #001080">controllerTarget</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;StoreController&quot;</span>
</code></pre>
				<p><strong>Note: using this type of interceptor is overridden if the target controller or endpoint has an interceptor configured</strong></p>
				<a href="#catching-errors" id="catching-errors" style="color: inherit; text-decoration: none;">
					<h3><a id="catching-errors"></a>Catching Errors</h3>
				</a>
				<p>You can use a try/catch block and the <code>Response</code> class to handle errors:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">Controller</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Controller</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/items&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">getItems</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">try</span><span style="color: #000000"> {</span>
<span style="color: #000000">            </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">getItemsFromDb</span><span style="color: #000000">()</span>
<span style="color: #000000">        } </span><span style="color: #AF00DB">catch</span><span style="color: #000000"> (</span><span style="color: #001080">ex</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #008000">// log ex...maybe?</span>

<span style="color: #000000">            </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">status</span><span style="color: #000000">(</span><span style="color: #098658">500</span><span style="color: #000000">).</span><span style="color: #795E26">send</span><span style="color: #000000">({</span>
<span style="color: #000000">                </span><span style="color: #001080">statusCode:</span><span style="color: #000000"> </span><span style="color: #098658">500</span><span style="color: #000000">,</span>
<span style="color: #000000">                </span><span style="color: #001080">errorMessage:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Error occurred getting items from backend&quot;</span>
<span style="color: #000000">            })</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">getItemsFromDb</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// get all the items from the DB</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><em>Note: this can also be done by injecting the <code>Response</code> class instance using the <code>response</code> parameter decorator, instead of extending <code>Controller</code>.</em></p>
				<a href="#framework-error-handling" id="framework-error-handling" style="color: inherit; text-decoration: none;">
					<h3><a id="framework-errors"></a>Framework Error Handling</h3>
				</a>
				<p>If you simply preform your logic in your endpoint method without catching any errors yourself, the framework will catch the error and return a HTTP 500 response with error details. Below is a JSON snippet showing an example.</p>
				<pre><code class="language-json"><span style="color: #000000">{</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;error&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;...some error that the framework caught when calling an endpoint....&quot;</span>
<span style="color: #000000">}</span>
</code></pre>
				<hr>
				<a href="#json-patch-requests" id="json-patch-requests" style="color: inherit; text-decoration: none;">
					<h2><a id="json-patch"></a>JSON Patch Requests</h2>
				</a>
				<hr>
				<p>This library supports <a href="http://jsonpatch.com/">JSON Patch</a> format for updating entities without having to upload the entire entity. To use it in your endpoints, ensure your controller extends the <code>Controller</code> class, an example is below:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">pathParam</span><span style="color: #000000">, </span><span style="color: #001080">produces</span><span style="color: #000000">, </span><span style="color: #001080">JsonPatch</span><span style="color: #000000">, </span><span style="color: #001080">PATCH</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Item</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./Item&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/store&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">StoreController</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Controller</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">PATCH</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/item/:id&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">modifyItem</span><span style="color: #000000">(@</span><span style="color: #795E26">pathParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;id&quot;</span><span style="color: #000000">) </span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">, @</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">jsonPatch</span><span style="color: #000000">: </span><span style="color: #267F99">JsonPatch</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">item</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">lookupItem</span><span style="color: #000000">(</span><span style="color: #001080">id</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #008000">// apply the patch operation</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">modifiedItem</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">applyJsonPatch</span><span style="color: #000000">&lt;</span><span style="color: #267F99">Item</span><span style="color: #000000">&gt;(</span><span style="color: #001080">jsonPatch</span><span style="color: #000000">, </span><span style="color: #001080">item</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #008000">// do something with modifiedItem</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">lookupItem</span><span style="color: #000000">(</span><span style="color: #001080">id</span><span style="color: #000000">: </span><span style="color: #267F99">string</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #008000">// go get the item from somewhere, db for example</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>Under the hood, the API uses the <a href="https://www.npmjs.com/package/fast-json-patch">fast-json-patch</a> package</strong></p>
				<hr>
				<a href="#request--response-context" id="request--response-context" style="color: inherit; text-decoration: none;">
					<h2><a id="req-res-context"></a>Request / Response Context</h2>
				</a>
				<hr>
				<p>If you want to read request bodies or write to the response, there are several supported approaches.</p>
				<a href="#extending-controller-class" id="extending-controller-class" style="color: inherit; text-decoration: none;">
					<h3><a id="extend-controller"></a>Extending Controller Class</h3>
				</a>
				<p>If you extend the controller class, you get access to the request and response context.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">Controller</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HelloWorldController</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Controller</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">queryStringParam</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">query</span><span style="color: #000000">[</span><span style="color: #A31515">&quot;someField&quot;</span><span style="color: #000000">]</span>

<span style="color: #000000">        </span><span style="color: #008000">// ... do some logic ...</span>

<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">html</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#using-decorators" id="using-decorators" style="color: inherit; text-decoration: none;">
					<h3><a id="use-decorators"></a>Using Decorators</h3>
				</a>
				<p>You can use parameter decorators to inject the request and response context.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">Request</span><span style="color: #000000">, </span><span style="color: #001080">Response</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">request</span><span style="color: #000000">, </span><span style="color: #001080">response</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">HelloWorldController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">(@</span><span style="color: #001080">request</span><span style="color: #000000"> </span><span style="color: #001080">request</span><span style="color: #000000">: </span><span style="color: #267F99">Request</span><span style="color: #000000">, @</span><span style="color: #001080">response</span><span style="color: #000000"> </span><span style="color: #001080">response</span><span style="color: #000000">: </span><span style="color: #267F99">Response</span><span style="color: #000000">) {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">queryStringParam</span><span style="color: #000000"> = </span><span style="color: #001080">request</span><span style="color: #000000">.</span><span style="color: #001080">query</span><span style="color: #000000">[</span><span style="color: #A31515">&quot;someField&quot;</span><span style="color: #000000">]</span>

<span style="color: #000000">        </span><span style="color: #008000">// ... do some logic ...</span>

<span style="color: #000000">        </span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">html</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;&lt;h1&gt;Hello World&lt;/h1&gt;&quot;</span><span style="color: #000000">);</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#returning-files-in-a-response" id="returning-files-in-a-response" style="color: inherit; text-decoration: none;">
					<h3><a id="send-files"></a>Returning Files in a Response</h3>
				</a>
				<p>You can return files by using the <code>sendFile</code> method in the response context.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">Controller</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/files&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">FilesController</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Controller</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000">: </span><span style="color: #267F99">Buffer</span><span style="color: #000000"> = </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">getFile</span><span style="color: #000000">()</span>

<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">sendFile</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">getFile</span><span style="color: #000000">(): </span><span style="color: #267F99">Buffer</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// ... do some logic to get a file Buffer ...</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>The <code>Request</code> and <code>Response</code> classes are documented in the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package.</strong></p>
				<hr>
				<a href="#-dependency-injection" id="-dependency-injection" style="color: inherit; text-decoration: none;">
					<h2><a id="di"></a> Dependency Injection</h2>
				</a>
				<hr>
				<p>Configuring the IOC container to enable dependency injection for your controllers is easy. Once you build an <code>ApiLambdaApp</code> instance you can call the <code>configureApp</code> method like below:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build config and controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>

<span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">configureApp</span><span style="color: #000000">(</span><span style="color: #001080">container</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// bind interface to implementation class, for example</span>
<span style="color: #000000">    </span><span style="color: #001080">container</span><span style="color: #000000">.</span><span style="color: #795E26">bind</span><span style="color: #000000">(</span><span style="color: #001080">IMyService</span><span style="color: #000000">)</span>
<span style="color: #000000">        .</span><span style="color: #795E26">to</span><span style="color: #000000">(</span><span style="color: #001080">MyServiceImplementation</span><span style="color: #000000">)</span>
<span style="color: #000000">})</span>

<span style="color: #008000">// export handler</span>
</code></pre>
				<p><strong>Note: Any classes that you are going to inject need to be decorated with <code>injectable</code>, any subclasses are also required to be decorated</strong></p>
				<p>In your controllers you can then use the registered types as constructor parameters:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">inject</span><span style="color: #000000">, </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">IMyService</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./IMyService&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">MyController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(@</span><span style="color: #795E26">inject</span><span style="color: #000000">(</span><span style="color: #001080">IMyService</span><span style="color: #000000">) </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">service</span><span style="color: #000000">: </span><span style="color: #267F99">IMyService</span><span style="color: #000000">) {</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// use injected service to do cool stuff</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>See the <a href="https://github.com/inversify/InversifyJS">InversifyJS</a> package documentation for full guidance how to use the <code>Container</code> class to manage dependencies.</p>
				<hr>
				<a href="#configuration" id="configuration" style="color: inherit; text-decoration: none;">
					<h2><a id="config"></a>Configuration</h2>
				</a>
				<hr>
				<p>When building an application instance you pass an <code>AppConfig</code> instance to the constructor. If you want to provide your own application config it is recommended to extend this class .</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">AppConfig</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">DatabaseConfig</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./DatabaseConfig&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">MyCustomConfig</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">AppConfig</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">databaseConfig</span><span style="color: #000000">: </span><span style="color: #267F99">DatabaseConfig</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>You can then configure the IOC container to bind to your configuration instance.</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appConfig</span><span style="color: #000000">: </span><span style="color: #267F99">MyCustomConfig</span><span style="color: #000000"> = </span><span style="color: #795E26">buildConfig</span><span style="color: #000000">()</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>

<span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">configureApp</span><span style="color: #000000">(</span><span style="color: #001080">container</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">container</span><span style="color: #000000">.</span><span style="color: #795E26">bind</span><span style="color: #000000">(</span><span style="color: #001080">MyCustomConfig</span><span style="color: #000000">)</span>
<span style="color: #000000">        .</span><span style="color: #795E26">toConstantValue</span><span style="color: #000000">(</span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// export handler</span>
</code></pre>
				<p>After which, you can inject your config into your controllers or services.</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">inject</span><span style="color: #000000">, </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">MyCustomConfig</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./MyCustomConfig&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/hello-world&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">MyController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(@</span><span style="color: #795E26">inject</span><span style="color: #000000">(</span><span style="color: #001080">MyCustomConfig</span><span style="color: #000000">) </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">config</span><span style="color: #000000">: </span><span style="color: #267F99">MyCustomConfig</span><span style="color: #000000">) {</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #795E26">getStuffFromDb</span><span style="color: #000000">()</span>
<span style="color: #000000">    }</span>

<span style="color: #000000">    </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #795E26">getStuffFromDb</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// use this.config to configure a database connection</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<p><strong>Note: The <code>AppConfig</code> class supports all the configuration fields documented in the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package.</strong></p>
				<a href="#reference" id="reference" style="color: inherit; text-decoration: none;">
					<h3><a id="config-reference"></a>Reference</h3>
				</a>
				<p>For a complete reference see the <a href="https://djfdyuruiry.github.io/ts-lambda-api/classes/appconfig.html">AppConfig</a> docs.</p>
				<a href="#lambda-api" id="lambda-api" style="color: inherit; text-decoration: none;">
					<h3><a id="lambda-api-config"></a>lambda-api</h3>
				</a>
				<p>Configuring <code>lambda-api</code> directly can be done by calling the <code>configureApi</code> method like below:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">API</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;lambda-api&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #0000FF">*</span><span style="color: #000000"> </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #001080">xmljs</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;xml-js&quot;</span>

<span style="color: #008000">// build config and controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>

<span style="color: #001080">app</span><span style="color: #000000">.</span><span style="color: #795E26">configureApi</span><span style="color: #000000">(</span><span style="color: #001080">api</span><span style="color: #000000">: </span><span style="color: #001080">API</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// add middleware handler, for example</span>
<span style="color: #000000">    </span><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">use</span><span style="color: #000000">((</span><span style="color: #001080">req</span><span style="color: #000000">,</span><span style="color: #001080">res</span><span style="color: #000000">,</span><span style="color: #001080">next</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> {</span>
<span style="color: #000000">        </span><span style="color: #008000">// parses any incoming XML data into an object</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">headers</span><span style="color: #000000">[</span><span style="color: #A31515">&quot;content-type&quot;</span><span style="color: #000000">] === </span><span style="color: #A31515">&quot;application/xml&quot;</span><span style="color: #000000">) {</span>
<span style="color: #000000">            </span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">body</span><span style="color: #000000"> = </span><span style="color: #001080">xmljs</span><span style="color: #000000">.</span><span style="color: #795E26">xml2json</span><span style="color: #000000">(</span><span style="color: #001080">req</span><span style="color: #000000">.</span><span style="color: #001080">body</span><span style="color: #000000">, {</span><span style="color: #001080">compact:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000">})</span>
<span style="color: #000000">        }</span>

<span style="color: #000000">        </span><span style="color: #795E26">next</span><span style="color: #000000">()</span>
<span style="color: #000000">    })</span>
<span style="color: #000000">})</span>
<span style="color: #008000">// export handler</span>
</code></pre>
				<p><strong>Note: any middleware handlers and manual routes will not apply auth filters, authorizers or error interceptors</strong></p>
				<p>See the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package documentation for guidance how to use the <code>API</code> class.</p>
				<a href="#logging" id="logging" style="color: inherit; text-decoration: none;">
					<h2><a id="logging"></a>Logging</h2>
				</a>
				<p>A logger interface is provided that can write messages to standard out. You can configure this logger using the <code>serverLogging</code> key in the <code>AppConfig</code> class. See the <a href="#config-reference">Config Reference</a> for details on options available. This complements the existing logging provided by <code>lambda-api</code>, which can be configured using the <code>logger</code> key.</p>
				<p>By default, the logger is set to <code>info</code> and outputs messages as simple strings.</p>
				<p>The format of the messages written out is:</p>
				<pre><code><span style="color: #001080">level</span><span style="color: #000000">  </span><span style="color: #0000FF">class</span><span style="color: #000000">                   </span><span style="color: #267F99">message</span>
<span style="color: #267F99">vvvvv</span><span style="color: #000000"> </span><span style="color: #267F99">vvvvvvvv</span><span style="color: #000000">   </span><span style="color: #267F99">vvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvvv</span>
<span style="color: #267F99">INFO</span><span style="color: #000000">  </span><span style="color: #267F99">Endpoint</span><span style="color: #000000"> - </span><span style="color: #267F99">Invoking</span><span style="color: #000000"> </span><span style="color: #267F99">endpoint</span><span style="color: #000000">: [</span><span style="color: #267F99">GET</span><span style="color: #000000">] /</span><span style="color: #267F99">open</span><span style="color: #000000">-</span><span style="color: #267F99">api</span><span style="color: #000000">.</span><span style="color: #267F99">yml</span>
</code></pre>
				<p>Below is some example output, include a stack trace from an <code>Error</code> instance:</p>
				<pre><code><span style="color: #0070C1">INFO</span><span style="color: #000000"> </span><span style="color: #001080">ApiLambdaApp</span><span style="color: #000000"> - </span><span style="color: #001080">Received</span><span style="color: #000000"> </span><span style="color: #001080">event</span><span style="color: #000000">, </span><span style="color: #001080">initialising</span><span style="color: #000000"> </span><span style="color: #001080">controllers</span><span style="color: #000000"> </span><span style="color: #001080">and</span><span style="color: #000000"> </span><span style="color: #001080">processing</span><span style="color: #000000"> </span><span style="color: #001080">event</span>
<span style="color: #0070C1">INFO</span><span style="color: #000000"> </span><span style="color: #001080">Server</span><span style="color: #000000"> - </span><span style="color: #001080">Processing</span><span style="color: #000000"> </span><span style="color: #0070C1">API</span><span style="color: #000000"> </span><span style="color: #001080">request</span><span style="color: #000000"> </span><span style="color: #001080">event</span><span style="color: #000000"> </span><span style="color: #001080">for</span><span style="color: #000000"> path:</span><span style="color: #811F3F"> /test/</span>
<span style="color: #0070C1">INFO</span><span style="color: #000000"> </span><span style="color: #001080">Endpoint</span><span style="color: #000000"> - [</span><span style="color: #0070C1">GET</span><span style="color: #000000">] /</span><span style="color: #001080">test</span><span style="color: #000000"> - </span><span style="color: #001080">Authenticating</span><span style="color: #000000"> </span><span style="color: #001080">request</span>
<span style="color: #0070C1">ERROR</span><span style="color: #000000"> </span><span style="color: #001080">Endpoint</span><span style="color: #000000"> - [</span><span style="color: #0070C1">GET</span><span style="color: #000000">] /</span><span style="color: #001080">test</span><span style="color: #000000"> - </span><span style="color: #267F99">Error</span><span style="color: #000000"> </span><span style="color: #001080">processing</span><span style="color: #000000"> </span><span style="color: #001080">endpoint</span><span style="color: #000000"> </span><span style="color: #001080">request</span>
<span style="color: #000000">Error: </span><span style="color: #001080">authenticate</span><span style="color: #000000"> </span><span style="color: #001080">failed</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #001080">TestAuthFilter</span><span style="color: #000000">.</span><span style="color: #795E26">authenticate</span><span style="color: #000000"> (/</span><span style="color: #001080">home</span><span style="color: #000000">/</span><span style="color: #001080">matthew</span><span style="color: #000000">/</span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">ts</span><span style="color: #000000">/</span><span style="color: #001080">ts</span><span style="color: #000000">-</span><span style="color: #001080">lambda</span><span style="color: #000000">-</span><span style="color: #001080">api</span><span style="color: #000000">/</span><span style="color: #001080">tests</span><span style="color: #000000">/</span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">test</span><span style="color: #000000">-</span><span style="color: #001080">components</span><span style="color: #000000">/</span><span style="color: #001080">TestAuthFilter</span><span style="color: #000000">.</span><span style="color: #001080">ts</span><span style="color: #000000">:</span><span style="color: #098658">25</span><span style="color: #000000">:</span><span style="color: #098658">19</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #001080">Endpoint</span><span style="color: #000000">.</span><span style="color: #795E26">authenticateRequest</span><span style="color: #000000"> (/</span><span style="color: #001080">home</span><span style="color: #000000">/</span><span style="color: #001080">matthew</span><span style="color: #000000">/</span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">ts</span><span style="color: #000000">/</span><span style="color: #001080">ts</span><span style="color: #000000">-</span><span style="color: #001080">lambda</span><span style="color: #000000">-</span><span style="color: #001080">api</span><span style="color: #000000">/</span><span style="color: #001080">dist</span><span style="color: #000000">/</span><span style="color: #001080">api</span><span style="color: #000000">/</span><span style="color: #001080">Endpoint</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">15</span><span style="color: #000000">:</span><span style="color: #098658">2640</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #795E26">processTicksAndRejections</span><span style="color: #000000"> (</span><span style="color: #001080">internal</span><span style="color: #000000">/</span><span style="color: #001080">process</span><span style="color: #000000">/</span><span style="color: #001080">task_queues</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">86</span><span style="color: #000000">:</span><span style="color: #098658">5</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #001080">process</span><span style="color: #000000">.</span><span style="color: #001080">runNextTicks</span><span style="color: #000000"> [</span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">_tickCallback</span><span style="color: #000000">] (</span><span style="color: #001080">internal</span><span style="color: #000000">/</span><span style="color: #001080">process</span><span style="color: #000000">/</span><span style="color: #001080">task_queues</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">56</span><span style="color: #000000">:</span><span style="color: #098658">3</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #267F99">Function</span><span style="color: #000000">.</span><span style="color: #001080">Module</span><span style="color: #000000">.</span><span style="color: #795E26">runMain</span><span style="color: #000000"> (</span><span style="color: #001080">internal</span><span style="color: #000000">/</span><span style="color: #001080">modules</span><span style="color: #000000">/</span><span style="color: #001080">cjs</span><span style="color: #000000">/</span><span style="color: #001080">loader</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">880</span><span style="color: #000000">:</span><span style="color: #098658">11</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #795E26">runMain</span><span style="color: #000000"> (/</span><span style="color: #001080">home</span><span style="color: #000000">/</span><span style="color: #001080">matthew</span><span style="color: #000000">/.</span><span style="color: #001080">node</span><span style="color: #000000">-</span><span style="color: #001080">spawn</span><span style="color: #000000">-</span><span style="color: #001080">wrap</span><span style="color: #000000">-</span><span style="color: #098658">13541</span><span style="color: #000000">-13</span><span style="color: #001080">c0098ec456</span><span style="color: #000000">/</span><span style="color: #001080">node</span><span style="color: #000000">:</span><span style="color: #098658">68</span><span style="color: #000000">:</span><span style="color: #098658">10</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #267F99">Function</span><span style="color: #000000">.&lt;</span><span style="color: #001080">anonymous</span><span style="color: #000000">&gt; (/</span><span style="color: #001080">home</span><span style="color: #000000">/</span><span style="color: #001080">matthew</span><span style="color: #000000">/.</span><span style="color: #001080">node</span><span style="color: #000000">-</span><span style="color: #001080">spawn</span><span style="color: #000000">-</span><span style="color: #001080">wrap</span><span style="color: #000000">-</span><span style="color: #098658">13541</span><span style="color: #000000">-13</span><span style="color: #001080">c0098ec456</span><span style="color: #000000">/</span><span style="color: #001080">node</span><span style="color: #000000">:</span><span style="color: #098658">171</span><span style="color: #000000">:</span><span style="color: #098658">5</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #267F99">Object</span><span style="color: #000000">.&lt;</span><span style="color: #001080">anonymous</span><span style="color: #000000">&gt; (/</span><span style="color: #001080">home</span><span style="color: #000000">/</span><span style="color: #001080">matthew</span><span style="color: #000000">/</span><span style="color: #001080">src</span><span style="color: #000000">/</span><span style="color: #001080">ts</span><span style="color: #000000">/</span><span style="color: #001080">ts</span><span style="color: #000000">-</span><span style="color: #001080">lambda</span><span style="color: #000000">-</span><span style="color: #001080">api</span><span style="color: #000000">/</span><span style="color: #001080">node_modules</span><span style="color: #000000">/</span><span style="color: #001080">nyc</span><span style="color: #000000">/</span><span style="color: #001080">bin</span><span style="color: #000000">/</span><span style="color: #001080">wrap</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">23</span><span style="color: #000000">:</span><span style="color: #098658">4</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #001080">Module</span><span style="color: #000000">.</span><span style="color: #795E26">_compile</span><span style="color: #000000"> (</span><span style="color: #001080">internal</span><span style="color: #000000">/</span><span style="color: #001080">modules</span><span style="color: #000000">/</span><span style="color: #001080">cjs</span><span style="color: #000000">/</span><span style="color: #001080">loader</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">816</span><span style="color: #000000">:</span><span style="color: #098658">30</span><span style="color: #000000">)</span>
<span style="color: #000000">    </span><span style="color: #001080">at</span><span style="color: #000000"> </span><span style="color: #267F99">Object</span><span style="color: #000000">.</span><span style="color: #001080">Module</span><span style="color: #000000">.</span><span style="color: #001080">_extensions</span><span style="color: #000000">..</span><span style="color: #795E26">js</span><span style="color: #000000"> (</span><span style="color: #001080">internal</span><span style="color: #000000">/</span><span style="color: #001080">modules</span><span style="color: #000000">/</span><span style="color: #001080">cjs</span><span style="color: #000000">/</span><span style="color: #001080">loader</span><span style="color: #000000">.</span><span style="color: #001080">js</span><span style="color: #000000">:</span><span style="color: #098658">827</span><span style="color: #000000">:</span><span style="color: #098658">10</span><span style="color: #000000">)</span>
</code></pre>
				<p>If you set the <code>format</code> to <code>json</code> the log messages will look like this:</p>
				<pre><code class="language-json"><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;level&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;INFO&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;msg&quot;</span><span style="color: #000000">: </span><span style="color: #A31515">&quot;Endpoint - Invoking endpoint: [GET] /open-api.yml&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #0451A5">&quot;time&quot;</span><span style="color: #000000">: </span><span style="color: #098658">1555865906882</span><span style="color: #000000"> </span><span style="color: #008000">// milliseconds since epoch</span>
<span style="color: #000000">}</span>
</code></pre>
				<p>This format matches the keys used by the <code>lambda-api</code> framework in it&#39;s output.</p>
				<a href="#writing-logs" id="writing-logs" style="color: inherit; text-decoration: none;">
					<h3><a id="logging-writing"></a>Writing Logs</h3>
				</a>
				<p>To write logs you will ned a logger instance. There are three ways to get one:</p>
				<ul>
					<li>Extend the <code>Controller</code> class in your controller:</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiController</span><span style="color: #000000">, </span><span style="color: #001080">Controller</span><span style="color: #000000">, </span><span style="color: #001080">GET</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">TestController</span><span style="color: #000000"> </span><span style="color: #0000FF">extends</span><span style="color: #000000"> </span><span style="color: #267F99">Controller</span><span style="color: #000000"> {</span>
<span style="color: #000000">    @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">info</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;In GET method!&quot;</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;OK&quot;</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<ul>
					<li>Use a <code>LogFactory</code> instance to build it:</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">inject</span><span style="color: #000000">, </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">AppConfig</span><span style="color: #000000">, </span><span style="color: #001080">LogFactory</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">SomeServiceYouMightMake</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// get your app config using dependency injection</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">constructor</span><span style="color: #000000">(@</span><span style="color: #795E26">inject</span><span style="color: #000000">(</span><span style="color: #001080">AppConfig</span><span style="color: #000000">) </span><span style="color: #0000FF">private</span><span style="color: #000000"> </span><span style="color: #0000FF">readonly</span><span style="color: #000000"> </span><span style="color: #001080">appConfig</span><span style="color: #000000">: </span><span style="color: #267F99">AppConfig</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">doStuff</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">factory</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">LogFactory</span><span style="color: #000000">(</span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">logger</span><span style="color: #000000"> = </span><span style="color: #001080">factory</span><span style="color: #000000">.</span><span style="color: #795E26">getLogger</span><span style="color: #000000">(</span><span style="color: #001080">SomeServiceYouMightMake</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">debug</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Inside doStuff!&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<ul>
					<li>Use the <code>LogFactory</code> static methods to build it:</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">LogFactory</span><span style="color: #000000">, </span><span style="color: #001080">LogLevel</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">SomeServiceYouMightMake</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">doStuff</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #008000">// you can specify the level and format of the log</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">logger</span><span style="color: #000000"> = </span><span style="color: #001080">LogFactory</span><span style="color: #000000">.</span><span style="color: #795E26">getCustomLogger</span><span style="color: #000000">(</span><span style="color: #001080">SomeServiceYouMightMake</span><span style="color: #000000">, </span><span style="color: #001080">LogLevel</span><span style="color: #000000">.</span><span style="color: #001080">debug</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;json&quot;</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">debug</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Inside doStuff!&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#-server-logger-api" id="-server-logger-api" style="color: inherit; text-decoration: none;">
					<h3><a id="logging-api"></a> Server Logger API</h3>
				</a>
				<p>The logging API supports formatting of messages using the <a href="https://www.npmjs.com/package/sprintf-js"><code>sprintf-js</code></a> npm module, simply pass in your arguments and put placeholders in your message string:</p>
				<pre><code class="language-typescript"><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">warn</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Hello there %s, how are you?&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;Roy&quot;</span><span style="color: #000000">)</span>
<span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">debug</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Task status: %s. Task data: %j&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;success&quot;</span><span style="color: #000000">, {</span><span style="color: #001080">event:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;run batch&quot;</span><span style="color: #000000">})</span>
</code></pre>
				<p>Using this will help to speed up your app if you do a lot of logging, because uneccessary work to convert values to strings and the JSON serialization of debug messages will not take place if a higher error level is set.</p>
				<hr>
				<p>Below is an example of the methods available on logger instances:</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">LogFactory</span><span style="color: #000000">, </span><span style="color: #001080">LogLevel</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">SomeServiceYouMightMake</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">doStuff</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">logger</span><span style="color: #000000"> = </span><span style="color: #001080">LogFactory</span><span style="color: #000000">.</span><span style="color: #795E26">getCustomLogger</span><span style="color: #000000">(</span><span style="color: #001080">SomeServiceYouMightMake</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #008000">// different levels</span>
<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">trace</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;trace&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">fatal</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;fatal&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;error&quot;</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #008000">// log exceptions with stack traces, also supports formatting of message</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">exception</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #267F99">Error</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Bad stuff happened&quot;</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">errorWithStack</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;An error occurred somewhere, error code: %d&quot;</span><span style="color: #000000">, </span><span style="color: #001080">exception</span><span style="color: #000000">, </span><span style="color: #098658">20000</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #008000">// check if a level is enabled</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">debugEnabled</span><span style="color: #000000">()) {</span>
<span style="color: #000000">            </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">debug</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Mode #%d&quot;</span><span style="color: #000000">, </span><span style="color: #098658">355</span><span style="color: #000000">)</span>
<span style="color: #000000">        }</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">traceEnabled</span><span style="color: #000000">()) {</span>
<span style="color: #000000">            </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">trace</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Sending data: %j&quot;</span><span style="color: #000000">, {</span><span style="color: #001080">some:</span><span style="color: #000000"> {</span><span style="color: #001080">payload:</span><span style="color: #000000"> </span><span style="color: #098658">2345</span><span style="color: #000000">}})</span>
<span style="color: #000000">        }</span>

<span style="color: #000000">        </span><span style="color: #008000">// check if the logging is currenly off (i.e. level is set to `off`)</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">isOff</span><span style="color: #000000">()) {</span>
<span style="color: #000000">            </span><span style="color: #008000">// react to the cruel reality....</span>
<span style="color: #000000">        }</span>

<span style="color: #000000">        </span><span style="color: #008000">// pass level in as parameter</span>
<span style="color: #000000">        </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">LogLevel</span><span style="color: #000000">.</span><span style="color: #001080">info</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;Manual call to the %s method&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;log&quot;</span><span style="color: #000000">)</span>

<span style="color: #000000">        </span><span style="color: #008000">// check level is enabled using aparameter</span>
<span style="color: #000000">        </span><span style="color: #AF00DB">if</span><span style="color: #000000"> (</span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">levelEnabled</span><span style="color: #000000">(</span><span style="color: #001080">LogLevel</span><span style="color: #000000">.</span><span style="color: #001080">info</span><span style="color: #000000">)) {</span>
<span style="color: #000000">            </span><span style="color: #001080">logger</span><span style="color: #000000">.</span><span style="color: #795E26">info</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;I am enabled!&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">        }</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#lambda-api-1" id="lambda-api-1" style="color: inherit; text-decoration: none;">
					<h3><a id="lambda-api-logging"></a>lambda-api</h3>
				</a>
				<p>Logging is also provided by the <a href="https://github.com/jeremydaly/lambda-api">lambda-api</a> package, use the <code>AppConfig</code> instance passed to <code>ApiLambdaApp</code> to configure logging using the <code>logger</code> key. See the <a href="#config-reference">Config Reference</a> for details on options available.</p>
				<hr>
				<a href="#openapi-swagger" id="openapi-swagger" style="color: inherit; text-decoration: none;">
					<h2><a id="open-api"></a>OpenAPI (Swagger)</h2>
				</a>
				<hr>
				<p>The OpenAPI Specification (FKA Swagger) is supported out of the box. If you are not familar with it, check out <a href="https://github.com/OAI/OpenAPI-Specification">https://github.com/OAI/OpenAPI-Specification</a></p>
				<p><strong>This framework supports only OpenAPI v3</strong></p>
				<p>The following features are supported:</p>
				<ul>
					<li>Generating of an OpenAPI Specification, which includes:<ul>
							<li>All endpoints with full path and HTTP method</li>
							<li>Custom names and descriptions for endpoints</li>
							<li>Grouping of endpoints together by API</li>
							<li>Endpoint query, path and header parameters (set by parameter decorators)</li>
							<li>Response content type headers (set by <code>produces</code> or <code>controllerProduces</code> decorators)</li>
							<li>Request and Response bodies: class types, primitive values and files</li>
							<li>Response HTTP status codes</li>
							<li>HTTP Basic security scheme (when a basic auth filter is configured)</li>
							<li>Custom auth filter security schemes</li>
						</ul>
					</li>
					<li>Specification files can be generated in <code>JSON</code> or <code>YAML</code> format (see <a href="#open-api-yaml">YAML Support</a>)</li>
				</ul>
				<p>To enable it, use the <code>openApi</code> property in the <code>AppConfig</code> class when building your app:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appConfig</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">AppConfig</span><span style="color: #000000">()</span>

<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">base</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;/api/v1&quot;</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">version</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;v1&quot;</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">openApi</span><span style="color: #000000">.</span><span style="color: #001080">enabled</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #008000">// export handler</span>
</code></pre>
				<p>You can then request your specification using the paths:</p>
				<ul>
					<li><code>/api/v1/open-api.json</code> - JSON format</li>
					<li><code>/api/v1/open-api.yml</code> - YAML format</li>
				</ul>
				<a href="#decorators" id="decorators" style="color: inherit; text-decoration: none;">
					<h3><a id="open-api-decorators"></a>Decorators</h3>
				</a>
				<p>To further document your API endpoints you can use OpenAPI decorators.</p>
				<ul>
					<li><p>Customize the names of APIs and endpoints using <code>api</code>:</p>
						<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">api</span><span style="color: #000000">, </span><span style="color: #001080">apiController</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/some&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">api</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Awesome API&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;descripton of API for doing amazing things&quot;</span><span style="color: #000000">) </span><span style="color: #008000">// the second parameter is optional</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">SomeController</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #008000">// ... endpoints ...</span>
<span style="color: #000000">}</span>
</code></pre>
					</li>
				</ul>
				<p><em>The same <code>@api</code> name can be used on multiple controllers, meaning you can group by API area rather than controller</em></p>
				<ul>
					<li><p>Add descriptions to APIs and endpoints using <code>apiOperation</code>:</p>
						<pre><code class="language-typescript"><span style="color: #000000">@</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({ </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;get stuff&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;go get some stuff&quot;</span><span style="color: #000000">}) </span><span style="color: #008000">// description is optional</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;OK&quot;</span>
<span style="color: #000000">}</span>
</code></pre>
					</li>
					<li><p>Describe endpoint request and response content using <code>apiRequest</code> and <code>apiResponse</code>:</p>
						<pre><code class="language-typescript"><span style="color: #008000">// using model classes</span>
<span style="color: #000000">@</span><span style="color: #795E26">POST</span><span style="color: #000000">()</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({</span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;add stuff&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;go add some stuff&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiRequest</span><span style="color: #000000">({</span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">201</span><span style="color: #000000">, {</span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">}) </span><span style="color: #008000">// each response is associated with a HTTP status code</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">400</span><span style="color: #000000">, {</span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">ApiError</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">500</span><span style="color: #000000">, {</span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">ApiError</span><span style="color: #000000">})</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">post</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">person</span><span style="color: #000000">: </span><span style="color: #001080">Person</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">person</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// using primitive types (&quot;boolean&quot;, &quot;double&quot;, &quot;int&quot;, &quot;number&quot;, &quot;object&quot; or &quot;string&quot;)</span>
<span style="color: #000000">@</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/plain&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({ </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;add some plain stuff&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;plain stuff&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiRequest</span><span style="color: #000000">({</span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;int&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">200</span><span style="color: #000000">, {</span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;int&quot;</span><span style="color: #000000">})</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">postNumber</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">stuff</span><span style="color: #000000">: </span><span style="color: #001080">number</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">stuff</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// using array types (&quot;array&quot;, &quot;array-array&quot;, &quot;boolean-array&quot;, &quot;double-array&quot;, &quot;int-array&quot;, &quot;number-array&quot;, &quot;object-array&quot; or &quot;string-array&quot;)</span>
<span style="color: #000000">@</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/array&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({ </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;add array&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;array time&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiRequest</span><span style="color: #000000">({</span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;string-array&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">200</span><span style="color: #000000">, {</span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;string-array&quot;</span><span style="color: #000000">})</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">postArray</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">stuff</span><span style="color: #000000">: </span><span style="color: #001080">string</span><span style="color: #000000">[]) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">stuff</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// upload/download files</span>
<span style="color: #000000">@</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/files&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({ </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;add file&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;give me a file&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiRequest</span><span style="color: #000000">({</span><span style="color: #001080">contentType:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;application/octet-stream&quot;</span><span style="color: #000000">, </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;file&quot;</span><span style="color: #000000">}) </span><span style="color: #008000">// contentType can be used in any request or response definition, inherits controller or endpoint type by default</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">201</span><span style="color: #000000">, {</span><span style="color: #001080">contentType:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;application/octet-stream&quot;</span><span style="color: #000000">, </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;file&quot;</span><span style="color: #000000">})</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">postFile</span><span style="color: #000000">(@</span><span style="color: #001080">rawBody</span><span style="color: #000000"> </span><span style="color: #001080">file</span><span style="color: #000000">: </span><span style="color: #001080">Buffer</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">sendFile</span><span style="color: #000000">(</span><span style="color: #001080">file</span><span style="color: #000000">)</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// providing custom request/response body example</span>
<span style="color: #000000">@</span><span style="color: #795E26">POST</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/custom-info&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;add custom stuff&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;go add some custom stuff&quot;</span>
<span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiRequest</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">example:</span><span style="color: #000000"> </span><span style="color: #A31515">`{&quot;name&quot;: &quot;some name&quot;, &quot;age&quot;: 22}`</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Details for a person&quot;</span>
<span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">201</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">example:</span><span style="color: #000000"> </span><span style="color: #A31515">`{&quot;name&quot;: &quot;another name&quot;, &quot;age&quot;: 30}`</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;Uploaded person information&quot;</span>
<span style="color: #000000">})</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">postCustomInfo</span><span style="color: #000000">(@</span><span style="color: #001080">body</span><span style="color: #000000"> </span><span style="color: #001080">person</span><span style="color: #000000">: </span><span style="color: #001080">Person</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">person</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// no response content, only a status code</span>
<span style="color: #000000">@</span><span style="color: #795E26">DELETE</span><span style="color: #000000">()</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({</span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;delete stuff&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;go delete some stuff&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiResponse</span><span style="color: #000000">(</span><span style="color: #098658">204</span><span style="color: #000000">)</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #0000FF">delete</span><span style="color: #000000">() {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">response</span><span style="color: #000000">.</span><span style="color: #795E26">status</span><span style="color: #000000">(</span><span style="color: #098658">204</span><span style="color: #000000">).</span><span style="color: #795E26">send</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">}</span>
</code></pre>
					</li>
					<li><p>Hide controllers or individual endpoints from the documentation with <code>apiIgnoreController</code> and <code>apiIgnore</code>:</p>
						<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">injectable</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;inversify&quot;</span>
<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">api</span><span style="color: #000000">, </span><span style="color: #001080">apiController</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiController</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;/private&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">api</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;Private API&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;You can still annotate these&quot;</span><span style="color: #000000">)</span>
<span style="color: #000000">@</span><span style="color: #795E26">apiIgnoreController</span><span style="color: #000000">()</span>
<span style="color: #000000">@</span><span style="color: #795E26">injectable</span><span style="color: #000000">()</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">PrivateController</span><span style="color: #000000"> {</span>

<span style="color: #000000">  @</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #000000">  @</span><span style="color: #795E26">apiOperation</span><span style="color: #000000">({ </span><span style="color: #001080">name:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;get stuff&quot;</span><span style="color: #000000">, </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;go get some stuff&quot;</span><span style="color: #000000">})</span>
<span style="color: #000000">  @</span><span style="color: #795E26">apiIgnore</span><span style="color: #000000">() </span><span style="color: #008000">// if you didn&#039;t want to ignore the whole controller</span>
<span style="color: #000000">  </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">() {</span>
<span style="color: #000000">      </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;OK&quot;</span>
<span style="color: #000000">  }</span>
<span style="color: #000000">}</span>
</code></pre>
						<p>  The class <code>Person</code> is set as the request and response in several of the examples above. To help the framework provide meaningful request and response examples automatically, you must either:</p>
						<ol>
							<li>Provide a public static <code>example</code> method in your class, which will be called if found when generating an API spec. (recommended)</li>
						</ol>
						<pre><code class="language-typescript"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">age</span><span style="color: #000000">: </span><span style="color: #267F99">number</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">roles</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">[]</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">static</span><span style="color: #000000"> </span><span style="color: #795E26">example</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">person</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">Person</span><span style="color: #000000">()</span>

<span style="color: #000000">        </span><span style="color: #001080">person</span><span style="color: #000000">.</span><span style="color: #001080">name</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;name&quot;</span>
<span style="color: #000000">        </span><span style="color: #001080">person</span><span style="color: #000000">.</span><span style="color: #001080">age</span><span style="color: #000000"> = </span><span style="color: #098658">18</span>
<span style="color: #000000">        </span><span style="color: #001080">person</span><span style="color: #000000">.</span><span style="color: #001080">roles</span><span style="color: #000000"> = [</span><span style="color: #A31515">&quot;role1&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;role2&quot;</span><span style="color: #000000">, </span><span style="color: #A31515">&quot;roleN&quot;</span><span style="color: #000000">]</span>

<span style="color: #000000">        </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">person</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
						<p>  -OR-</p>
						<ol start="2">
							<li>Populate your instance in it&#39;s constructor with some non null/undefined values.</li>
						</ol>
						<pre><code class="language-typescript"><span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">Person</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">name</span><span style="color: #000000">: </span><span style="color: #267F99">string</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">age</span><span style="color: #000000">: </span><span style="color: #267F99">number</span>
<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #001080">roles</span><span style="color: #000000">?: </span><span style="color: #267F99">string</span><span style="color: #000000">[]</span>

<span style="color: #000000">    </span><span style="color: #0000FF">public</span><span style="color: #000000"> </span><span style="color: #0000FF">constructor</span><span style="color: #000000">() {</span>
<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">name</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;&quot;</span>
<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">age</span><span style="color: #000000"> = </span><span style="color: #098658">0</span>
<span style="color: #000000">        </span><span style="color: #0000FF">this</span><span style="color: #000000">.</span><span style="color: #001080">roles</span><span style="color: #000000"> = []</span>
<span style="color: #000000">    }</span>
<span style="color: #000000">}</span>
</code></pre>
						<p>  <em>This is required because object properties are not defined until a value is assigned, which makes any sort of reflection impossible.</em></p>
					</li>
					<li><p>Describe the path, query and header parameters consumed by your endpoints:</p>
						<pre><code class="language-typescript"><span style="color: #008000">// the below uses the same options used to describe api requests and responses</span>
<span style="color: #000000">@</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">get</span><span style="color: #000000">(</span>
<span style="color: #000000">    @</span><span style="color: #795E26">queryParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;param&quot;</span><span style="color: #000000">, { </span><span style="color: #001080">description:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;whatever you like&quot;</span><span style="color: #000000">, </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;int&quot;</span><span style="color: #000000"> }) </span><span style="color: #001080">param</span><span style="color: #000000">: </span><span style="color: #001080">string</span>
<span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// remember, defining a type does not affect the parameter type, will always be a string</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">param</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// You can mark query and header params as required or not,</span>
<span style="color: #008000">// path parameters are always set to required.</span>
<span style="color: #000000">@</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">getAnotherThing</span><span style="color: #000000">(</span>
<span style="color: #000000">    @</span><span style="color: #795E26">header</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;x-param&quot;</span><span style="color: #000000">, { </span><span style="color: #001080">required:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000"> }) </span><span style="color: #001080">param</span><span style="color: #000000">: </span><span style="color: #001080">string</span>
<span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// remember, defining required will not perform any validation, null/undefined will</span>
<span style="color: #000000">    </span><span style="color: #008000">// still be passed if the parameter is missing from the request</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">param</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// When expecting an object/array, you can pass in the</span>
<span style="color: #008000">// expected formatting style.</span>
<span style="color: #008000">//</span>
<span style="color: #008000">// For help with the `style` field, see: https://swagger.io/docs/specification/serialization/</span>
<span style="color: #000000">@</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">getAnotherThing</span><span style="color: #000000">(</span>
<span style="color: #000000">    @</span><span style="color: #795E26">queryParam</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;param&quot;</span><span style="color: #000000">, { </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;int-array&quot;</span><span style="color: #000000">, </span><span style="color: #001080">style:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;pipeDelimited&quot;</span><span style="color: #000000">, </span><span style="color: #001080">explode:</span><span style="color: #000000"> </span><span style="color: #0000FF">false</span><span style="color: #000000"> }) </span><span style="color: #001080">param</span><span style="color: #000000">: </span><span style="color: #001080">string</span>
<span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// we would expect param to be passed in the query string as &#039;param=1|2|3|4&#039;</span>
<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">param</span>
<span style="color: #000000">}</span>

<span style="color: #008000">// you can specify a content type if the string is expected to be JSON etc.</span>
<span style="color: #000000">@</span><span style="color: #795E26">GET</span><span style="color: #000000">()</span>
<span style="color: #001080">public</span><span style="color: #000000"> </span><span style="color: #795E26">getHeaderTest</span><span style="color: #000000">(</span>
<span style="color: #000000">    @</span><span style="color: #795E26">header</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;x-custom-header&quot;</span><span style="color: #000000">, { </span><span style="color: #001080">class:</span><span style="color: #000000"> </span><span style="color: #001080">Person</span><span style="color: #000000">, </span><span style="color: #001080">contentType:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;application/json&quot;</span><span style="color: #000000"> }) </span><span style="color: #001080">customHeader</span><span style="color: #000000">: </span><span style="color: #001080">string</span>
<span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">person</span><span style="color: #000000">: </span><span style="color: #267F99">Person</span><span style="color: #000000"> = </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">customHeader</span><span style="color: #000000">)</span>

<span style="color: #000000">    </span><span style="color: #AF00DB">return</span><span style="color: #000000"> </span><span style="color: #001080">person</span>
<span style="color: #000000">}</span>
</code></pre>
						<p>  <em>Path parameters support the following styles: simple, label, matrix</em></p>
						<p>  <em>Header parameters only support the &#39;simple&#39; style</em></p>
						<p>  <em>Note: Setting a content type for your parameter is supported, but due to an outstanding issue, these parameters will not display in Swagger UI / Editor, see: <a href="https://github.com/swagger-api/swagger-ui/issues/4442">https://github.com/swagger-api/swagger-ui/issues/4442</a></em></p>
					</li>
					<li><p>Add security schemes to your specification (other than Basic auth, this is automatically detected) using an <code>apiSecurity</code> decorator on your authentication filter:</p>
						<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">apiSecurity</span><span style="color: #000000">, </span><span style="color: #001080">IAuthFilter</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;ts-lambda-api&quot;</span>

<span style="color: #AF00DB">import</span><span style="color: #000000"> { </span><span style="color: #001080">User</span><span style="color: #000000"> } </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;./User&quot;</span>

<span style="color: #000000">@</span><span style="color: #795E26">apiSecurity</span><span style="color: #000000">(</span><span style="color: #A31515">&quot;bearerAuth&quot;</span><span style="color: #000000">, {</span>
<span style="color: #000000">    </span><span style="color: #001080">type:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;http&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">scheme:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;bearer&quot;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">bearerFormat:</span><span style="color: #000000"> </span><span style="color: #A31515">&quot;JWT&quot;</span>
<span style="color: #000000">})</span>
<span style="color: #AF00DB">export</span><span style="color: #000000"> </span><span style="color: #0000FF">class</span><span style="color: #000000"> </span><span style="color: #267F99">CustomAuthFilter</span><span style="color: #000000"> </span><span style="color: #0000FF">implements</span><span style="color: #000000"> </span><span style="color: #267F99">IAuthFilter</span><span style="color: #000000">&lt;</span><span style="color: #267F99">string</span><span style="color: #000000">, </span><span style="color: #267F99">User</span><span style="color: #000000">&gt; {</span>
<span style="color: #000000">    </span><span style="color: #008000">// ... implementation ...</span>
<span style="color: #000000">}</span>
</code></pre>
						<p>  This decorator uses the <code>SecuritySchemeObject</code> class from the <code>openapi3-ts</code> library to describe the security scheme in place. See the source for more information on using this class: <a href="https://github.com/metadevpro/openapi3-ts/blob/ab997f12a63fa215e3b0c08cc293429b97ce0a44/src/model/OpenApi.ts#L314">SecuritySchemeObject source</a></p>
					</li>
				</ul>
				<a href="#yaml-support" id="yaml-support" style="color: inherit; text-decoration: none;">
					<h3><a id="open-api-yaml"></a>YAML Support</h3>
				</a>
				<p>For <code>YAML</code> specification support, you need to install the following packages in your project:</p>
				<pre><code class="language-bash"><span style="color: #000000">npm install js-yaml</span>
<span style="color: #000000">npm install -D @types/js-yaml</span>
</code></pre>
				<a href="#authentication" id="authentication" style="color: inherit; text-decoration: none;">
					<h3><a id="open-api-auth"></a>Authentication</h3>
				</a>
				<p>By default the OpenAPI endpoints do not require authentication. If you wish to apply auth filters when a request is made for a spec, set the <code>useAuthentication</code> key in the <code>openApi</code> config:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// build controllers path...</span>
<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">appConfig</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">AppConfig</span><span style="color: #000000">()</span>

<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">base</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;/api/v1&quot;</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">version</span><span style="color: #000000"> = </span><span style="color: #A31515">&quot;v1&quot;</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">openApi</span><span style="color: #000000">.</span><span style="color: #001080">enabled</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span>
<span style="color: #001080">appConfig</span><span style="color: #000000">.</span><span style="color: #001080">openApi</span><span style="color: #000000">.</span><span style="color: #001080">useAuthentication</span><span style="color: #000000"> = </span><span style="color: #0000FF">true</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">app</span><span style="color: #000000"> = </span><span style="color: #0000FF">new</span><span style="color: #000000"> </span><span style="color: #795E26">ApiLambdaApp</span><span style="color: #000000">(</span><span style="color: #001080">controllersPath</span><span style="color: #000000">, </span><span style="color: #001080">appConfig</span><span style="color: #000000">)</span>
<span style="color: #008000">// export handler</span>
</code></pre>
				<hr>
				<a href="#testing" id="testing" style="color: inherit; text-decoration: none;">
					<h2><a id="testing"></a>Testing</h2>
				</a>
				<hr>
				<p>For local dev testing and integration with acceptance tests see the <a href="https://www.npmjs.com/package/ts-lambda-api-local">ts-lambda-api-local</a> package which enables hosting your API using express as a local HTTP server.</p>
				<p>Check out this project&#39;s dev dependencies to see what is required to test API code. The <code>tests</code> directory of this repo contains extensive acceptance tests which will show you how to build mock requests and invoke your API endpoints programmatically.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-enum">
						<a href="enums/loglevel.html" class="tsd-kind-icon">Log<wbr>Level</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/apiapp.html" class="tsd-kind-icon">Api<wbr>App</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/apierror.html" class="tsd-kind-icon">Api<wbr>Error</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/apilambdaapp.html" class="tsd-kind-icon">Api<wbr>Lambda<wbr>App</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/apirequest.html" class="tsd-kind-icon">Api<wbr>Request</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/apiresponse.html" class="tsd-kind-icon">Api<wbr>Response</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/appconfig.html" class="tsd-kind-icon">App<wbr>Config</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/basicauth.html" class="tsd-kind-icon">Basic<wbr>Auth</a>
					</li>
					<li class=" tsd-kind-class tsd-has-type-parameter">
						<a href="classes/basicauthfilter.html" class="tsd-kind-icon">Basic<wbr>Auth<wbr>Filter</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/controller.html" class="tsd-kind-icon">Controller</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/errorinterceptor.html" class="tsd-kind-icon">Error<wbr>Interceptor</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/logfactory.html" class="tsd-kind-icon">Log<wbr>Factory</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/middlewareregistry.html" class="tsd-kind-icon">Middleware<wbr>Registry</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/openapiconfig.html" class="tsd-kind-icon">Open<wbr>Api<wbr>Config</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/principal.html" class="tsd-kind-icon">Principal</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/requestbuilder.html" class="tsd-kind-icon">Request<wbr>Builder</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/server.html" class="tsd-kind-icon">Server</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/serverloggerconfig.html" class="tsd-kind-icon">Server<wbr>Logger<wbr>Config</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/iauthfilter.html" class="tsd-kind-icon">IAuth<wbr>Filter</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/iauthorizer.html" class="tsd-kind-icon">IAuthorizer</a>
					</li>
					<li class=" tsd-kind-interface tsd-has-type-parameter">
						<a href="interfaces/idictionary.html" class="tsd-kind-icon">IDictionary</a>
					</li>
					<li class=" tsd-kind-interface">
						<a href="interfaces/ilogger.html" class="tsd-kind-icon">ILogger</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#jsonpatch" class="tsd-kind-icon">Json<wbr>Patch</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#logformat" class="tsd-kind-icon">Log<wbr>Format</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#delete" class="tsd-kind-icon">DELETE</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#get" class="tsd-kind-icon">GET</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#patch" class="tsd-kind-icon">PATCH</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#post" class="tsd-kind-icon">POST</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#put" class="tsd-kind-icon">PUT</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#api" class="tsd-kind-icon">api</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apicontroller" class="tsd-kind-icon">api<wbr>Controller</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apiignore" class="tsd-kind-icon">api<wbr>Ignore</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apiignorecontroller" class="tsd-kind-icon">api<wbr>Ignore<wbr>Controller</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apioperation" class="tsd-kind-icon">api<wbr>Operation</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apirequest" class="tsd-kind-icon">api<wbr>Request</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apiresponse" class="tsd-kind-icon">api<wbr>Response</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#apisecurity" class="tsd-kind-icon">api<wbr>Security</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#body" class="tsd-kind-icon">body</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#consumes" class="tsd-kind-icon">consumes</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#controllerconsumes" class="tsd-kind-icon">controller<wbr>Consumes</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#controllererrorinterceptor" class="tsd-kind-icon">controller<wbr>Error<wbr>Interceptor</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#controllernoauth" class="tsd-kind-icon">controller<wbr>NoAuth</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#controllerproduces" class="tsd-kind-icon">controller<wbr>Produces</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#controllerrolesallowed" class="tsd-kind-icon">controller<wbr>Roles<wbr>Allowed</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#errorinterceptor" class="tsd-kind-icon">error<wbr>Interceptor</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#header" class="tsd-kind-icon">header</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#noauth" class="tsd-kind-icon">no<wbr>Auth</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#pathparam" class="tsd-kind-icon">path<wbr>Param</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#principal" class="tsd-kind-icon">principal</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#produces" class="tsd-kind-icon">produces</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#queryparam" class="tsd-kind-icon">query<wbr>Param</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#rawbody" class="tsd-kind-icon">raw<wbr>Body</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#request" class="tsd-kind-icon">request</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#response" class="tsd-kind-icon">response</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#rolesallowed" class="tsd-kind-icon">roles<wbr>Allowed</a>
					</li>
					<li class=" tsd-kind-function">
						<a href="modules.html#timed" class="tsd-kind-icon">timed</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>